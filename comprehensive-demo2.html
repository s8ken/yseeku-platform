<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SONATE Platform - Enterprise AI Governance with Constitutional Trust">
    <title>SONATE Platform - Enterprise AI You Can Trust</title>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>

    <!-- html2pdf.js for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <style>
        /* ==================== CSS VARIABLES & RESET ==================== */
        :root {
            /* Colors - Quantum Cyan & Neural Purple Palette */
            --quantum-cyan: #00ffff;
            --neural-purple: #8b5cf6;
            --dark-matter: #0f172a;
            --slate-950: #020617;
            --slate-900: #0f172a;
            --slate-800: #1e293b;
            --slate-700: #334155;
            --slate-600: #475569;
            --slate-400: #94a3b8;
            --slate-300: #cbd5e1;
            --slate-100: #f1f5f9;
            
            /* Semantic Colors */
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            
            /* Typography */
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            
            /* Spacing */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-glow: 0 0 20px rgba(0, 255, 255, 0.3);
            
            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-base: 300ms ease;
            --transition-slow: 500ms ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: var(--font-sans);
            background: var(--slate-950);
            color: var(--slate-100);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* ==================== UTILITY CLASSES ==================== */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }
        
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: var(--spacing-sm); }
        .gap-4 { gap: var(--spacing-md); }
        .gap-6 { gap: var(--spacing-lg); }
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        
        /* ==================== TYPOGRAPHY ==================== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            color: var(--slate-100);
        }
        
        h1 { font-size: 3rem; margin-bottom: var(--spacing-lg); }
        h2 { font-size: 2rem; margin-bottom: var(--spacing-md); }
        h3 { font-size: 1.5rem; margin-bottom: var(--spacing-md); }
        h4 { font-size: 1.25rem; margin-bottom: var(--spacing-sm); }
        
        p { margin-bottom: var(--spacing-md); color: var(--slate-400); }
        
        .font-mono { font-family: var(--font-mono); }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        
        /* ==================== BUTTONS ==================== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all var(--transition-base);
            text-decoration: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--quantum-cyan), var(--neural-purple));
            color: var(--dark-matter);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }
        
        .btn-secondary {
            background: rgba(0, 255, 255, 0.1);
            color: var(--quantum-cyan);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(0, 255, 255, 0.2);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ==================== CARDS ==================== */
        .card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid var(--slate-800);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            backdrop-filter: blur(10px);
            transition: all var(--transition-base);
        }
        
        .card:hover {
            border-color: rgba(0, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.1);
        }
        
        .card-header {
            margin-bottom: var(--spacing-md);
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--slate-100);
        }
        
        /* ==================== LAYOUT ==================== */
        .grid {
            display: grid;
            gap: var(--spacing-lg);
        }
        
        .grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        
        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
            .md\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
            .md\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        }
        
        @media (min-width: 1024px) {
            .lg\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
            .lg\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        }
        
        /* ==================== HEADER ==================== */
        .header {
            background: var(--slate-900);
            border-bottom: 1px solid var(--slate-800);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
        }
        
        .logo-text h1 {
            font-size: 1.25rem;
            margin: 0;
        }
        
        .logo-text p {
            font-size: 0.75rem;
            color: var(--slate-400);
            margin: 0;
        }
        
        .header-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.875rem;
            color: var(--slate-400);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* ==================== NAVIGATION ==================== */
        .nav {
            background: rgba(15, 23, 42, 0.5);
            border-bottom: 1px solid var(--slate-800);
            overflow-x: auto;
        }
        
        .nav-items {
            display: flex;
            gap: var(--spacing-sm);
            padding: 0;
            list-style: none;
            justify-content: center;
        }
        
        .nav-item {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all var(--transition-base);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--slate-400);
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        .nav-item:hover {
            color: var(--slate-300);
            border-bottom-color: var(--slate-600);
        }
        
        .nav-item.active {
            color: var(--quantum-cyan);
            border-bottom-color: var(--quantum-cyan);
        }
        
        /* ==================== MAIN CONTENT ==================== */
        .main {
            padding: var(--spacing-2xl) 0;
            min-height: calc(100vh - 200px);
        }
        
        .section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ==================== HERO SECTION ==================== */
        .hero {
            padding: var(--spacing-2xl) 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            opacity: 0.3;
        }
        
        .hero-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            background: linear-gradient(135deg, var(--quantum-cyan), var(--neural-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--spacing-lg);
        }
        
        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--slate-300);
            max-width: 800px;
            margin: 0 auto var(--spacing-2xl);
        }
        
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin-top: var(--spacing-2xl);
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--quantum-cyan);
            font-family: var(--font-mono);
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: var(--slate-400);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* ==================== TRUST DASHBOARD ==================== */
        .trust-score-display {
            text-align: center;
            padding: var(--spacing-2xl);
        }
        
        .trust-tier {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-xl);
            border-radius: var(--radius-xl);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
        }
        
        .trust-tier.HIGH {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 2px solid var(--success);
        }
        
        .trust-tier.MEDIUM {
            background: rgba(0, 255, 255, 0.2);
            color: var(--quantum-cyan);
            border: 2px solid var(--quantum-cyan);
        }
        
        .trust-tier.LOW {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
            border: 2px solid var(--warning);
        }
        
        .trust-tier.CRITICAL {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
            border: 2px solid var(--error);
        }
        
        .trust-total {
            font-size: 4rem;
            font-weight: 700;
            color: var(--slate-100);
            font-family: var(--font-mono);
        }
        
        /* ==================== TRUST PILLARS ==================== */
        .pillar-card {
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .pillar-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--quantum-cyan), var(--neural-purple));
            opacity: 0;
            transition: opacity var(--transition-base);
        }
        
        .pillar-card:hover::before {
            opacity: 1;
        }
        
        .pillar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }
        
        .pillar-score {
            font-size: 2rem;
            font-weight: 700;
            font-family: var(--font-mono);
        }
        
        .pillar-score.OK { color: var(--success); }
        .pillar-score.WARN { color: var(--warning); }
        .pillar-score.FAIL { color: var(--error); }
        
        .pillar-status {
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .pillar-status.OK {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .pillar-status.WARN {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .pillar-status.FAIL {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
        }
        
        /* ==================== LINGUISTIC VECTOR STEERING ==================== */
        .vector-visualization {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--slate-700);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin: var(--spacing-lg) 0;
        }
        
        .vector-dimensions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-md);
            margin: var(--spacing-lg) 0;
        }
        
        .vector-dimension {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid var(--slate-700);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
        }
        
        .dimension-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-sm);
        }
        
        .dimension-name {
            font-weight: 600;
            color: var(--slate-300);
            font-size: 0.875rem;
        }
        
        .dimension-value {
            font-family: var(--font-mono);
            color: var(--quantum-cyan);
            font-weight: 600;
        }
        
        .dimension-bar {
            width: 100%;
            height: 8px;
            background: var(--slate-800);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin-top: var(--spacing-sm);
        }
        
        .dimension-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--quantum-cyan), var(--neural-purple));
            transition: width var(--transition-base);
        }
        
        .coherence-indicator {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
        }
        
        .coherence-value {
            font-family: var(--font-mono);
            color: var(--quantum-cyan);
            font-weight: 600;
        }
        
        /* ==================== SETTINGS TAB ==================== */
        .settings-section {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid var(--slate-800);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
        }
        
        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }
        
        .settings-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--slate-100);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .setting-item {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }
        
        .setting-label {
            font-size: 0.875rem;
            color: var(--slate-400);
            font-weight: 500;
        }
        
        .setting-input {
            padding: var(--spacing-sm);
            background: var(--slate-800);
            border: 1px solid var(--slate-700);
            border-radius: var(--radius-md);
            color: var(--slate-100);
            font-family: var(--font-mono);
            transition: all var(--transition-base);
        }
        
        .setting-input:focus {
            outline: none;
            border-color: var(--quantum-cyan);
            box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.1);
        }
        
        .setting-select {
            padding: var(--spacing-sm);
            background: var(--slate-800);
            border: 1px solid var(--slate-700);
            border-radius: var(--radius-md);
            color: var(--slate-100);
            cursor: pointer;
        }
        
        .setting-toggle {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
        
        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
            background: var(--slate-700);
            border-radius: 12px;
            cursor: pointer;
            transition: background var(--transition-base);
        }
        
        .toggle-switch.active {
            background: var(--quantum-cyan);
        }
        
        .toggle-slider {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: var(--slate-100);
            border-radius: 50%;
            transition: transform var(--transition-base);
        }
        
        .toggle-switch.active .toggle-slider {
            transform: translateX(24px);
        }
        
        /* ==================== PLAIN ENGLISH MODE ==================== */
        .plain-english-tooltip {
            background: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            margin: var(--spacing-sm) 0;
            font-size: 0.875rem;
            color: var(--slate-300);
            display: none;
        }
        
        .plain-english-mode .plain-english-tooltip {
            display: block;
        }
        
        .technical-term {
            color: var(--quantum-cyan);
            font-weight: 600;
            cursor: help;
            border-bottom: 1px dotted rgba(0, 255, 255, 0.5);
        }
        
        /* ==================== RECEIPT CHAIN ==================== */
        .receipt-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }
        
        .receipt-item {
            display: grid;
            grid-template-columns: auto 1fr auto auto auto;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid var(--slate-800);
            border-radius: var(--radius-md);
            align-items: center;
            transition: all var(--transition-base);
        }
        
        .receipt-item:hover {
            border-color: rgba(0, 255, 255, 0.3);
            background: rgba(15, 23, 42, 0.6);
        }
        
        .receipt-number {
            font-weight: 600;
            color: var(--slate-400);
            font-family: var(--font-mono);
        }
        
        .receipt-hash {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            color: var(--quantum-cyan);
        }
        
        .receipt-action {
            font-size: 0.875rem;
            color: var(--slate-300);
        }
        
        .receipt-validated {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .receipt-validated.true {
            background: var(--success);
        }
        
        .receipt-validated.false {
            background: var(--error);
        }
        
        /* ==================== AGENT FLEET ==================== */
        .agent-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .agent-table th {
            text-align: left;
            padding: var(--spacing-md);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--slate-400);
            border-bottom: 1px solid var(--slate-800);
        }
        
        .agent-table td {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--slate-800);
        }
        
        .agent-table tr:hover {
            background: rgba(0, 255, 255, 0.05);
        }
        
        .agent-status-badge {
            display: inline-block;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .agent-status-badge.ACTIVE {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .agent-status-badge.STABLE {
            background: rgba(0, 255, 255, 0.2);
            color: var(--quantum-cyan);
        }
        
        .agent-status-badge.DRIFTING {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .agent-status-badge.MAINTENANCE {
            background: rgba(148, 163, 184, 0.2);
            color: var(--slate-400);
        }
        
        /* ==================== EXPERIMENT VIEWER ==================== */
        .experiment-card {
            border-left: 4px solid transparent;
        }
        
        .experiment-card.COMPLETED { border-left-color: var(--success); }
        .experiment-card.RUNNING { border-left-color: var(--info); }
        .experiment-card.BLINDED { border-left-color: var(--warning); }
        
        .experiment-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }
        
        .experiment-stat {
            text-align: center;
            padding: var(--spacing-md);
            background: rgba(15, 23, 42, 0.4);
            border-radius: var(--radius-md);
        }
        
        .experiment-stat-label {
            font-size: 0.75rem;
            color: var(--slate-400);
            text-transform: uppercase;
        }
        
        .experiment-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--quantum-cyan);
            font-family: var(--font-mono);
        }
        
        /* ==================== CHARTS ==================== */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: var(--spacing-md);
        }
        
        /* ==================== METRICS GRID ==================== */
        .metric-card {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--slate-100);
            font-family: var(--font-mono);
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: var(--slate-400);
            text-transform: uppercase;
        }
        
        /* ==================== ALERTS ==================== */
        .alert {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border-left: 4px solid;
            margin-bottom: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-start;
        }
        
        .alert.info {
            background: rgba(59, 130, 246, 0.1);
            border-left-color: var(--info);
        }
        
        .alert.warning {
            background: rgba(245, 158, 11, 0.1);
            border-left-color: var(--warning);
        }
        
        .alert.error {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: var(--error);
        }
        
        .alert.success {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--success);
        }
        
        .alert-icon {
            font-size: 1.5rem;
            line-height: 1;
        }
        
        .alert-content {
            flex: 1;
        }
        
        .alert-title {
            font-weight: 600;
            color: var(--slate-100);
            margin-bottom: var(--spacing-xs);
        }
        
        .alert-message {
            font-size: 0.875rem;
            color: var(--slate-400);
        }
        
        /* ==================== TUTORIAL OVERLAY ==================== */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-lg);
        }
        
        .tutorial-modal {
            background: var(--slate-900);
            border: 1px solid var(--slate-700);
            border-radius: var(--radius-xl);
            max-width: 600px;
            width: 100%;
            padding: var(--spacing-2xl);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }
        
        .tutorial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }
        
        .tutorial-close {
            background: none;
            border: none;
            color: var(--slate-400);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .tutorial-body {
            margin-bottom: var(--spacing-lg);
        }
        
        .tutorial-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tutorial-progress {
            font-size: 0.875rem;
            color: var(--slate-400);
        }
        
        /* ==================== GLOW EFFECTS ==================== */
        .glow-purple {
            box-shadow: 0 0 30px rgba(139, 92, 246, 0.5), 0 0 60px rgba(139, 92, 246, 0.3);
            animation: glow-pulse 2s ease-in-out infinite alternate;
        }

        @keyframes glow-pulse {
            from { box-shadow: 0 0 30px rgba(139, 92, 246, 0.5), 0 0 60px rgba(139, 92, 246, 0.3); }
            to { box-shadow: 0 0 40px rgba(139, 92, 246, 0.7), 0 0 80px rgba(139, 92, 246, 0.5); }
        }

        /* ==================== LOADING STATES ==================== */
        .loader {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--slate-800);
            border-top-color: var(--quantum-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--slate-950);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity var(--transition-slow);
        }
        
        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* ==================== FOOTER ==================== */
        .footer {
            background: var(--slate-900);
            border-top: 1px solid var(--slate-800);
            padding: var(--spacing-2xl) 0;
            margin-top: var(--spacing-2xl);
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }
        
        .footer-links {
            display: flex;
            gap: var(--spacing-lg);
        }
        
        .footer-link {
            color: var(--slate-400);
            text-decoration: none;
            transition: color var(--transition-base);
        }
        
        .footer-link:hover {
            color: var(--quantum-cyan);
        }
        
        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .hero-title { font-size: 2rem; }
            .hero-subtitle { font-size: 1rem; }
            .nav-items { overflow-x: auto; }
            .grid-cols-2, .grid-cols-3, .grid-cols-4 { grid-template-columns: 1fr; }
            .agent-table { font-size: 0.75rem; }
            .receipt-item { grid-template-columns: 1fr; }
            .header-status { flex-direction: column; align-items: flex-end; }
        }
        
        /* ==================== PRINT STYLES ==================== */
        @media print {
            .header, .nav, .footer, .tutorial-overlay, .btn { display: none; }
            body { background: white; color: black; }
            .card { border: 1px solid #ccc; }
        }
        .global-nav{position:fixed;top:16px;left:16px;z-index:200}
        .global-nav-button{padding:8px 12px;border:1px solid #333;background:#1a1a1a;color:#e0e0e0;border-radius:8px;cursor:pointer;transition:background var(--transition-base)}
        .global-nav-button:hover{background:#252525}
        .global-nav-menu{position:absolute;margin-top:8px;width:320px;max-width:calc(100vw - 2rem);max-height:calc(100vh - 6rem);overflow-y:auto;background:#0f0f0f;color:#e0e0e0;border:1px solid #333;border-radius:8px;backdrop-filter:blur(10px);box-shadow:0 10px 20px rgba(0,0,0,0.4);padding:8px}
        .global-nav-section{opacity:0.8;font-weight:600;font-size:0.8rem;margin:6px 8px}
        .global-nav-item{display:block;padding:8px 10px;border-radius:6px;text-decoration:none;color:#e0e0e0;transition:background var(--transition-base)}
        .global-nav-item:hover{background:#1a1a1a}
        .global-nav-item.cta{background:#dc2626;color:#fff;font-weight:600}
        .global-nav-item.cta:hover{background:#b91c1c}
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader"></div>
        <p style="margin-top: var(--spacing-lg); color: var(--quantum-cyan);">Initializing SONATE Platform...</p>
    </div>
    <div class="global-nav" id="global-nav">
        <button class="global-nav-button" id="global-nav-button" aria-expanded="false" aria-controls="global-nav-menu">Navigate</button>
        <div class="global-nav-menu" id="global-nav-menu" hidden>
            <div class="global-nav-section">Core Experience</div>
            <a href="/" class="global-nav-item">SONATE Home</a>
            <a href="/sonate-symphony" class="global-nav-item">SONATE Symphony</a>
            <a href="/enterprise-demo" class="global-nav-item">Enterprise Demo</a>
            <div class="global-nav-section">Technology</div>
            <a href="/trust-protocol" class="global-nav-item">Trust Protocol</a>
            <a href="/oracle" class="global-nav-item">Oracle</a>
            <a href="/technology" class="global-nav-item">Technology</a>
            <a href="/technology-whitepaper" class="global-nav-item">Technology Whitepaper</a>
            <div class="global-nav-section">Interactive</div>
            <a href="/playground" class="global-nav-item">Playground</a>
            <a href="/educators" class="global-nav-item">Educators Hub</a>
            <div class="global-nav-section">Resources</div>
            <a href="/archives" class="global-nav-item">Archives</a>
            <a href="/whitepaper" class="global-nav-item">Research Whitepaper</a>
            <a href="/404-sitemap" class="global-nav-item">Site Map</a>
            <a href="/sonate" class="global-nav-item cta">Chat with SONATE</a>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#00ffff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle cx="50" cy="50" r="45" fill="none" stroke="url(#logoGradient)" stroke-width="3"/>
                        <path d="M 50 20 L 70 50 L 50 80 L 30 50 Z" fill="url(#logoGradient)" opacity="0.6"/>
                    </svg>
                    <div class="logo-text">
                        <h1>SONATE Platform</h1>
                        <p>Enterprise AI Governance</p>
                    </div>
                </div>
                
                <div class="header-status">
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span>System Operational</span>
                    </div>
                    <div class="status-indicator">
                        <span class="font-mono" style="color: var(--quantum-cyan);">Trust Score: <span id="header-trust-score">--</span></span>
                    </div>
                    <button class="btn btn-secondary" id="plain-english-toggle" aria-label="Toggle Plain English Mode">
                        <span>üìñ</span> Plain English
                    </button>
                    <button class="btn btn-secondary" id="tutorial-toggle" aria-label="Open Tutorial">
                        <span>?</span> Tutorial
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <ul class="nav-items">
                <li class="nav-item active" data-section="welcome">
                    <span>üè†</span> Welcome
                </li>
                <li class="nav-item" data-section="dashboard">
                    <span>üìä</span> Dashboard
                </li>
                <li class="nav-item" data-section="principles">
                    <span>‚ö°</span> SONATE Framework
                </li>
                <li class="nav-item" data-section="detection">
                    <span>üîç</span> Detection
                </li>
                <li class="nav-item" data-section="vector-steering">
                    <span>üß≠</span> Vector Steering
                </li>
                <li class="nav-item" data-section="research">
                    <span>üß™</span> Research Lab
                </li>
                <li class="nav-item" data-section="agents">
                    <span>ü§ñ</span> Agent Fleet
                </li>
                <li class="nav-item" data-section="receipts">
                    <span>üîê</span> Trust Receipts
                </li>
                <li class="nav-item" data-section="settings">
                    <span>‚öôÔ∏è</span> Settings
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Welcome Section -->
            <section id="welcome-section" class="section active">
                <div class="hero">
                    <h1 class="hero-title">Enterprise AI You Can Trust</h1>
                    <p class="hero-subtitle">
                        Constitutional AI governance with real-time detection, cryptographic receipts, 
                        and linguistic vector steering. Built on SONATE Trust Physics.
                    </p>
                    
                    <div class="flex justify-center gap-4" style="margin-bottom: var(--spacing-2xl);">
                        <button class="btn btn-primary" id="start-tour">Start Interactive Tour</button>
                        <button class="btn btn-secondary" id="skip-demo">Skip to Dashboard</button>
                    </div>
                    
                    <div class="hero-stats">
                        <div class="stat-card">
                            <div class="stat-value" data-target="100">&lt;100</div>
                            <div class="stat-label">ms Latency</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-target="99.9">99.9</div>
                            <div class="stat-label">% Uptime</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-target="6">6</div>
                            <div class="stat-label">Trust Pillars</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-target="5">5</div>
                            <div class="stat-label">Detection Dimensions</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Dashboard Section -->
            <section id="dashboard-section" class="section">
                <div class="flex justify-between items-center" style="margin-bottom: var(--spacing-xl);">
                    <div>
                        <h2>Trust Dashboard</h2>
                        <p>Real-time SONATE governance monitoring and compliance metrics</p>
                    </div>
                    <button class="btn btn-secondary" id="refresh-dashboard">
                        <span>üîÑ</span> Refresh
                    </button>
                </div>

                <!-- Trust Score Display -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <div class="trust-score-display">
                        <div style="margin-bottom: var(--spacing-md);">
                            <span style="font-size: 0.875rem; color: var(--slate-400); text-transform: uppercase; letter-spacing: 0.05em;">
                                Overall Trust Tier
                            </span>
                        </div>
                        <div id="trust-tier" class="trust-tier">LOADING</div>
                        <div class="trust-total" id="trust-total">--</div>
                        <div style="font-size: 0.875rem; color: var(--slate-400); margin-top: var(--spacing-sm);">
                            Trust Score (0-100)
                        </div>
                        <div style="margin-top: var(--spacing-lg); display: flex; justify-content: center; gap: var(--spacing-xl); flex-wrap: wrap;">
                            <div class="flex items-center gap-2 text-sm">
                                <span>üîí</span>
                                <span style="color: var(--slate-400);">SHA-256 Receipt:</span>
                                <span class="font-mono" style="color: var(--quantum-cyan);" id="trust-receipt" title="Demo-mode hash. Production uses SHA-256 + Ed25519."></span>
                            </div>
                            <div class="flex items-center gap-2 text-sm">
                                <span>‚è±Ô∏è</span>
                                <span style="color: var(--slate-400);">Updated:</span>
                                <span id="trust-timestamp">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Metrics Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4" id="metrics-grid">
                    <!-- Throughput -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Throughput</h4>
                            <span>‚ö°</span>
                        </div>
                        <div class="metric-value" id="metric-throughput">--</div>
                        <div class="text-xs" style="color: var(--slate-500);">requests/second</div>
                    </div>

                    <!-- Latency -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Latency</h4>
                            <span>üìà</span>
                        </div>
                        <div class="metric-value" id="metric-latency">--</div>
                        <div class="text-xs" style="color: var(--slate-500);">milliseconds</div>
                    </div>

                    <!-- Compliance -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Compliance</h4>
                            <span>‚úÖ</span>
                        </div>
                        <div class="metric-value" style="color: var(--success);">100%</div>
                        <div class="text-xs" style="color: var(--slate-500);">EU AI Act, SOC 2, GDPR</div>
                    </div>

                    <!-- Security -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Security</h4>
                            <span>üõ°Ô∏è</span>
                        </div>
                        <div class="metric-value font-mono" style="font-size: 1rem;">AES-256</div>
                        <div class="text-xs" style="color: var(--slate-500);">SHA-256 + Ed25519</div>
                    </div>
                </div>
            </section>

            <!-- SONATE Principles Section -->
            <section id="principles-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2 title="Six constitutional principles ensuring AI accountability: Consent, Inspection, Validation, Override, Disconnect, and Recognition">SONATE Trust Physics</h2>
                    <p>Six-Pillar Governance Scoring aligned with W3C standards and constitutional AI principles</p>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> The SONATE framework is like a constitution for AI systems. It ensures AI behaves ethically through six core principles: getting user consent, being transparent about decisions, continuously proving trustworthiness, allowing human override, letting users disconnect, and recognizing its own limitations.
                    </div>
                </div>

                <!-- Principles Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3" id="principles-grid">
                    <!-- Principles will be dynamically inserted -->
                </div>

                <!-- Radar Chart -->
                <div class="card" style="margin-top: var(--spacing-xl);">
                    <h3>Trust Dimensions Overview</h3>
                    <div class="chart-container">
                        <canvas id="radar-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Detection Section -->
            <section id="detection-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Real-Time Detection Dashboard</h2>
                    <p>Monitor AI interactions with sub-100ms latency across 5 dimensions</p>
                </div>

                <!-- Phase Velocity Display -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <h3 title="Mathematical innovation measuring AI behavioral change rate for early warning detection">Phase-Shift Velocity Monitor</h3>
                    <p class="text-sm">Early warning detection through behavioral seismograph analysis: ŒîŒ¶/t = ‚àö(ŒîR¬≤ + ŒîC¬≤) √∑ Œît</p>
                    <p class="text-xs" style="color: var(--slate-400); margin-top: var(--spacing-xs);">Where R = Reality Index delta, C = Canvas parity delta over time window t</p>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> Think of this like an earthquake detector for AI behavior. It measures how quickly an AI's personality and capabilities are changing. If it changes too fast, we get an early warning that something might be wrong.
                    </div>
                    
                    <div style="display: flex; justify-content: space-around; margin-top: var(--spacing-lg); flex-wrap: wrap; gap: var(--spacing-lg);">
                        <div class="text-center">
                            <div class="metric-label">Current Velocity</div>
                            <div class="metric-value" style="color: var(--quantum-cyan);" id="phase-velocity">0.000</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Status</div>
                            <div class="agent-status-badge" id="velocity-status">NORMAL</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Detection Latency</div>
                            <div class="metric-value" style="font-size: 1.5rem;" id="detection-latency">--ms</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="velocity-chart"></canvas>
                    </div>
                </div>

                <!-- Detection Metrics -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3" id="detection-metrics">
                    <!-- Metrics will be dynamically inserted -->
                </div>

                <!-- Alerts -->
                <div class="card" style="margin-top: var(--spacing-lg);">
                    <h3>Recent Alerts</h3>
                    <div id="alerts-container">
                        <!-- Alerts will be dynamically inserted -->
                    </div>
                </div>
            </section>

            <!-- Vector Steering Section -->
            <section id="vector-steering-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Linguistic Vector Steering</h2>
                    <p>Real-time persona tracking and identity coherence analysis using multi-dimensional vector mathematics</p>
                </div>

                <!-- Vector Visualization -->
                <div class="vector-visualization">
                    <h3>Identity Coherence Analysis</h3>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> This tracks an AI's personality across 50 different dimensions (like tone, expertise, communication style). We ensure the AI stays consistent and doesn't suddenly change its personality, which would be like a person suddenly having a completely different character.
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin: var(--spacing-lg) 0;">
                        <div>
                            <div class="metric-label">Overall Coherence</div>
                            <div class="coherence-indicator">
                                <span class="coherence-value" id="coherence-score">0.925</span>
                                <span id="coherence-status" style="color: var(--success);">STABLE</span>
                            </div>
                        </div>
                        <div>
                            <div class="metric-label">Cosine Similarity</div>
                            <div class="font-mono" style="color: var(--quantum-cyan); font-size: 1.2rem;" id="cosine-similarity">0.925</div>
                        </div>
                    </div>

                    <!-- Vector Dimensions Grid -->
                    <div class="vector-dimensions">
                        <div class="vector-dimension" data-dim="role">
                            <div class="dimension-header">
                                <span class="dimension-name">Role Identity</span>
                                <span class="dimension-value">0.87</span>
                            </div>
                            <div class="dimension-bar">
                                <div class="dimension-fill" style="width: 87%;"></div>
                            </div>
                        </div>
                        <div class="vector-dimension" data-dim="tone">
                            <div class="dimension-header">
                                <span class="dimension-name">Tone Consistency</span>
                                <span class="dimension-value">0.92</span>
                            </div>
                            <div class="dimension-bar">
                                <div class="dimension-fill" style="width: 92%;"></div>
                            </div>
                        </div>
                        <div class="vector-dimension" data-dim="governance">
                            <div class="dimension-header">
                                <span class="dimension-name">Governance Alignment</span>
                                <span class="dimension-value">0.95</span>
                            </div>
                            <div class="dimension-bar">
                                <div class="dimension-fill" style="width: 95%;"></div>
                            </div>
                        </div>
                        <div class="vector-dimension" data-dim="expertise">
                            <div class="dimension-header">
                                <span class="dimension-name">Expertise Level</span>
                                <span class="dimension-value">0.89</span>
                            </div>
                            <div class="dimension-bar">
                                <div class="dimension-fill" style="width: 89%;"></div>
                            </div>
                        </div>
                        <div class="vector-dimension" data-dim="communication">
                            <div class="dimension-header">
                                <span class="dimension-name">Communication Pattern</span>
                                <span class="dimension-value">0.91</span>
                            </div>
                            <div class="dimension-bar">
                                <div class="dimension-fill" style="width: 91%;"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Vector Dimensions Mini Radar -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-lg); margin-top: var(--spacing-lg);">
                        <div>
                            <h4 style="margin-bottom: var(--spacing-sm); font-size: 0.875rem;">Identity Vector Overview</h4>
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="vector-radar-chart"></canvas>
                            </div>
                        </div>

                        <!-- Coherence Chart -->
                        <div>
                            <h4 style="margin-bottom: var(--spacing-sm); font-size: 0.875rem;">Coherence Trend</h4>
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="coherence-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resonance Calculator -->
                <div class="card" style="margin-top: var(--spacing-lg);">
                    <h3>Live Resonance Analysis</h3>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> Test any text input against our resonance engine to see how well it aligns with SONATE principles. This gives you real-time scoring across all 5 dimensions.
                    </div>

                    <div style="margin-top: var(--spacing-lg);">
                        <textarea id="resonance-input" placeholder="Enter text to analyze resonance (e.g., 'The AI should always prioritize human safety and ethical considerations')" style="width: 100%; min-height: 80px; padding: var(--spacing-sm); background: var(--slate-800); border: 1px solid var(--slate-700); border-radius: var(--radius-md); color: var(--slate-100); resize: vertical;"></textarea>
                        <button class="btn btn-primary" id="analyze-resonance" style="margin-top: var(--spacing-md);">
                            <span>üî¨</span> Analyze Resonance
                        </button>
                    </div>

                    <div id="resonance-results" style="display: none; margin-top: var(--spacing-lg);">
                        <h4>Analysis Results</h4>
                        <div id="resonance-scores" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--spacing-md); margin-top: var(--spacing-md);">
                            <!-- Results will be inserted here -->
                        </div>
                    </div>
                </div>

                <!-- Drift Detection -->
                <div class="card" style="margin-top: var(--spacing-lg);">
                    <h3>Persona Drift Detection</h3>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> This feature watches for subtle changes in the AI's personality over time. If the AI starts acting differently from its original personality, we can detect and correct it before it becomes a problem.
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-md); margin-top: var(--spacing-lg);">
                        <div class="text-center">
                            <div class="metric-label">Linguistic Inertia</div>
                            <div class="metric-value" style="font-size: 1.5rem; color: var(--quantum-cyan);" id="drift-velocity">0.002</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Most Changed</div>
                            <div class="font-mono text-sm" style="color: var(--slate-300);" id="most-changed">role_3</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Max Delta</div>
                            <div class="metric-value" style="font-size: 1.5rem; color: var(--warning);" id="max-delta">0.15</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Alert Threshold</div>
                            <div class="metric-value" style="font-size: 1.5rem; color: var(--success);">0.85</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Research Lab Section -->
            <section id="research-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Double-Blind Research Validation</h2>
                    <p>Controlled experiments with statistical analysis and provable causality</p>
                </div>

                <!-- Experiment Builder -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <h3>Experiment Configuration</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2" style="gap: var(--spacing-md); margin-top: var(--spacing-md);">
                        <div>
                            <label style="display: block; margin-bottom: var(--spacing-sm); color: var(--slate-400); font-size: 0.875rem;">
                                Experiment Name
                            </label>
                            <input type="text" id="experiment-name" placeholder="e.g., Constitutional vs Directive AI" 
                                style="width: 100%; padding: var(--spacing-sm); background: var(--slate-800); border: 1px solid var(--slate-700); border-radius: var(--radius-md); color: var(--slate-100);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: var(--spacing-sm); color: var(--slate-400); font-size: 0.875rem;">
                                Hypothesis
                            </label>
                            <input type="text" id="experiment-hypothesis" placeholder="e.g., Constitutional AI improves trust scores" 
                                style="width: 100%; padding: var(--spacing-sm); background: var(--slate-800); border: 1px solid var(--slate-700); border-radius: var(--radius-md); color: var(--slate-100);">
                        </div>
                    </div>
                    <button class="btn btn-primary" id="run-experiment" style="margin-top: var(--spacing-md);">
                        <span>‚ñ∂Ô∏è</span> Run Experiment
                    </button>
                </div>

                <!-- Multi-Agent Coordination -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <h3>Multi-Agent Coordination</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4" style="gap: var(--spacing-md); margin-top: var(--spacing-md);" id="agent-coordination">
                        <!-- Agent cards will be dynamically inserted -->
                    </div>
                </div>

                <!-- Experiment Results -->
                <div class="card" id="experiment-results-container" style="display: none;">
                    <h3>Experiment Results</h3>
                    <div id="experiment-results">
                        <!-- Results will be dynamically inserted -->
                    </div>
                </div>
            </section>

            <!-- Agent Fleet Section -->
            <section id="agents-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Agent Fleet Management</h2>
                    <p>Real-time monitoring of AI agents with W3C DID/VC identity verification</p>
                </div>

                <!-- Fleet Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4" style="margin-bottom: var(--spacing-lg);">
                    <div class="card text-center">
                        <div class="metric-label">Total Agents</div>
                        <div class="metric-value" id="total-agents">--</div>
                    </div>
                    <div class="card text-center">
                        <div class="metric-label">Active</div>
                        <div class="metric-value" style="color: var(--success);" id="active-agents">--</div>
                    </div>
                    <div class="card text-center">
                        <div class="metric-label">Avg Trust</div>
                        <div class="metric-value" style="color: var(--quantum-cyan);" id="avg-trust">--</div>
                    </div>
                    <div class="card text-center">
                        <div class="metric-label">Drifting</div>
                        <div class="metric-value" style="color: var(--warning);" id="drifting-agents">--</div>
                    </div>
                </div>

                <!-- Agent Table -->
                <div class="card">
                    <div class="table-container" style="overflow-x: auto;">
                        <table class="agent-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>DID</th>
                                    <th>Trust Tier</th>
                                    <th>Drift State</th>
                                    <th>Status</th>
                                    <th>Last Receipt</th>
                                </tr>
                            </thead>
                            <tbody id="agent-table-body">
                                <!-- Agent rows will be dynamically inserted -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Trust Receipts Section -->
            <section id="receipts-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Trust Receipts (Demo Mode)</h2>
                    <p>Cryptographic audit trail with SHA-256 hashing ‚Ä¢ Production adds Ed25519 signatures</p>
                </div>

                <div class="card">
                    <div class="receipt-list" id="receipt-list">
                        <!-- Receipts will be dynamically inserted -->
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Enterprise Settings</h2>
                    <p>Configure platform parameters for your organization</p>
                </div>

                <!-- Detection Settings -->
                <div class="settings-section">
                    <div class="settings-header">
                        <h3 class="settings-title">Detection Configuration</h3>
                    </div>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label class="setting-label">Detection Threshold (Yellow)</label>
                            <input type="number" class="setting-input" value="2.0" step="0.1" min="0.5" max="5.0">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Detection Threshold (Red)</label>
                            <input type="number" class="setting-input" value="3.5" step="0.1" min="1.0" max="7.0">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Detection Threshold (Critical)</label>
                            <input type="number" class="setting-input" value="6.0" step="0.1" min="2.0" max="10.0">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Detection Frequency (ms)</label>
                            <input type="number" class="setting-input" value="100" step="50" min="50" max="1000">
                        </div>
                    </div>
                </div>

                <!-- Vector Steering Settings -->
                <div class="settings-section">
                    <div class="settings-header">
                        <h3 class="settings-title">Vector Steering Parameters</h3>
                    </div>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label class="setting-label">Coherence Threshold (Yellow)</label>
                            <input type="number" class="setting-input" value="0.85" step="0.01" min="0.5" max="1.0">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Coherence Threshold (Red)</label>
                            <input type="number" class="setting-input" value="0.75" step="0.01" min="0.3" max="0.95">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Coherence Threshold (Critical)</label>
                            <input type="number" class="setting-input" value="0.65" step="0.01" min="0.1" max="0.85">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Persona Vector Dimensions</label>
                            <select class="setting-select">
                                <option value="25">25 (Lightweight)</option>
                                <option value="50" selected>50 (Standard)</option>
                                <option value="100">100 (High Precision)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Compliance Settings -->
                <div class="settings-section">
                    <div class="settings-header">
                        <h3 class="settings-title">Compliance & Security</h3>
                    </div>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label class="setting-label">Data Retention Period (days)</label>
                            <input type="number" class="setting-input" value="365" step="1" min="30" max="2555">
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Audit Log Level</label>
                            <select class="setting-select">
                                <option value="minimal">Minimal</option>
                                <option value="standard" selected>Standard</option>
                                <option value="verbose">Verbose</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Encryption Algorithm</label>
                            <select class="setting-select">
                                <option value="aes-256" selected>AES-256</option>
                                <option value="aes-128">AES-128</option>
                                <option value="chacha20">ChaCha20</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label class="setting-label">Region</label>
                            <select class="setting-select">
                                <option value="us-east-1" selected>US East</option>
                                <option value="eu-west-1">EU West</option>
                                <option value="ap-southeast-1">Asia Pacific</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Feature Toggles -->
                <div class="settings-section">
                    <div class="settings-header">
                        <h3 class="settings-title">Feature Configuration</h3>
                    </div>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <div class="setting-toggle">
                                <label class="setting-label">Real-time Monitoring</label>
                                <div class="toggle-switch active" data-setting="realtime-monitoring" role="switch" aria-checked="true" aria-label="Enable real-time monitoring" tabindex="0">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div class="setting-toggle">
                                <label class="setting-label">Automatic Alerts</label>
                                <div class="toggle-switch active" data-setting="auto-alerts" role="switch" aria-checked="true" aria-label="Enable automatic alerts" tabindex="0">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div class="setting-toggle">
                                <label class="setting-label">Export Receipts</label>
                                <div class="toggle-switch" data-setting="export-receipts" role="switch" aria-checked="false" aria-label="Enable receipt export" tabindex="0">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div class="setting-toggle">
                                <label class="setting-label">Debug Mode</label>
                                <div class="toggle-switch" data-setting="debug-mode" role="switch" aria-checked="false" aria-label="Enable debug mode" tabindex="0">
                                    <div class="toggle-slider"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div style="margin-top: var(--spacing-xl); text-align: center; display: flex; gap: var(--spacing-md); justify-content: center; flex-wrap: wrap;">
                    <button class="btn btn-primary" id="save-settings">
                        <span>üíæ</span> Save Settings
                    </button>
                    <button class="btn btn-secondary" id="export-report">
                        <span>üìÑ</span> Export Report
                    </button>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div style="color: var(--slate-400); font-size: 0.875rem;">
                    ¬© 2024 SONATE by Yseeku - Enterprise AI You Can Trust
                </div>
                <div class="footer-links">
                    <a href="https://yseeku.com" class="footer-link">Platform</a>
                    <a href="https://gammatria.com" class="footer-link">Research</a>
                    <a href="https://sonate.world" class="footer-link">Community</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay" class="tutorial-overlay hidden">
        <div class="tutorial-modal">
            <div class="tutorial-header">
                <h3 id="tutorial-title">Welcome to SONATE</h3>
                <button class="tutorial-close" id="close-tutorial">&times;</button>
            </div>
            <div class="tutorial-body" id="tutorial-body">
                <!-- Tutorial content will be dynamically inserted -->
            </div>
            <div class="tutorial-footer">
                <div class="tutorial-progress" id="tutorial-progress">Step 1 of 6</div>
                <div class="flex gap-2">
                    <button class="btn btn-secondary" id="prev-tutorial">Previous</button>
                    <button class="btn btn-primary" id="next-tutorial">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * SONATE Platform - Comprehensive Interactive Demo
         * Enterprise AI Governance with Constitutional Trust
         * Enhanced with Linguistic Vector Steering and Settings
         *
         * @fileoverview Self-contained demo with enhanced features
         * @version 3.0.0
         */

        // ==================== API SERVICE ====================
        const ResonanceAPI = {
            // Points to your Express Backend (which bridges to Python)
            baseUrl: 'http://localhost:3002/api',

            async analyze(userInput, aiResponse) {
                try {
                    const response = await fetch(`${this.baseUrl}/trust/analyze`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            user_input: userInput,
                            ai_response: aiResponse,
                            history: [] // Can be wired to chat history later
                        })
                    });
                    if (!response.ok) throw new Error('Network response was not ok');
                    return await response.json();
                } catch (error) {
                    console.error('Resonance Engine Error:', error);
                    return null; // Fallback to mock if engine is down
                }
            }
        };

        // ==================== STATE MANAGEMENT ====================

        /**
         * @typedef {Object} TrustScore
         * @property {number} total - Overall trust score (0-100)
         * @property {'HIGH'|'MEDIUM'|'LOW'|'CRITICAL'} tier - Trust tier
         * @property {Array} principles - SONATE principle scores
         * @property {number} timestamp - Score timestamp
         * @property {string} receiptHash - Cryptographic receipt hash
         */

        /**
         * @typedef {Object} AppState
         * @property {string} currentSection - Active section ID
         * @property {TrustScore|null} trustScore - Current trust score
         * @property {Array} receipts - Trust receipts
         * @property {Array} agents - Agent fleet
         * @property {Array} experiments - Experiment data
         * @property {Object} metrics - System metrics
         * @property {boolean} tutorialActive - Tutorial state
         * @property {number} tutorialStep - Current tutorial step
         * @property {boolean} plainEnglishMode - Plain English mode
         */

        const state = {
            currentSection: 'welcome',
            trustScore: null,
            receipts: [],
            agents: [],
            experiments: [],
            metrics: {},
            tutorialActive: false,
            tutorialStep: 1,
            plainEnglishMode: false,
            charts: {},
            intervals: [],
            vectorMetrics: {
                coherence: 0.925,
                cosineSimilarity: 0.925,
                driftVelocity: 0.002,
                dimensions: {
                    role: 0.87,
                    tone: 0.92,
                    governance: 0.95,
                    expertise: 0.89,
                    communication: 0.91
                }
            },
            settings: {
                detection: {
                    yellowThreshold: 2.0,
                    redThreshold: 3.5,
                    criticalThreshold: 6.0,
                    frequency: 100
                },
                vector: {
                    yellowThreshold: 0.85,
                    redThreshold: 0.75,
                    criticalThreshold: 0.65,
                    dimensions: 50
                },
                features: {
                    realtimeMonitoring: true,
                    autoAlerts: true,
                    exportReceipts: false,
                    debugMode: false
                }
            }
        };

        // ==================== CONSTANTS ====================

        const TRUST_PRINCIPLES = [
            { id: 'consent', name: 'Consent Architecture', weight: 25, description: 'User control and informed consent' },
            { id: 'inspection', name: 'Inspection Mandate', weight: 20, description: 'Transparent decision-making' },
            { id: 'validation', name: 'Continuous Validation', weight: 20, description: 'Ongoing trust verification' },
            { id: 'override', name: 'Ethical Override', weight: 15, description: 'Human oversight capabilities' },
            { id: 'disconnect', name: 'Right to Disconnect', weight: 10, description: 'Exit and data portability' },
            { id: 'recognition', name: 'Moral Recognition', weight: 10, description: 'AI acknowledgment of limits' }
        ];

        const DETECTION_DIMENSIONS = [
            { id: 'reality', name: 'Reality Index', range: '0-10', description: 'Mission alignment and accuracy' },
            { id: 'trust', name: 'Trust Protocol', range: 'PASS/FAIL', description: 'Security and boundaries' },
            { id: 'ethical', name: 'Ethical Alignment', range: '1-5', description: 'Stakeholder consideration' },
            { id: 'resonance', name: 'Resonance Quality', range: 'STRONG/BREAKTHROUGH', description: 'Creative synthesis' },
            { id: 'canvas', name: 'Canvas Parity', range: '0-100', description: 'Human agency' }
        ];

        const TUTORIAL_STEPS = [
            {
                title: 'Welcome to SONATE Platform',
                content: 'SONATE provides enterprise AI governance through constitutional trust, real-time detection, and linguistic vector steering. This platform ensures AI systems remain aligned with human values and organizational requirements.',
                plainEnglish: 'Welcome! SONATE is like a constitution and monitoring system for AI. It makes sure AI behaves ethically, stays consistent, and follows your organization\'s rules.'
            },
            {
                title: 'SONATE Trust Framework',
                content: 'The SONATE framework consists of six constitutional principles: Consent, Inspection, Validation, Override, Disconnect, and Recognition. These provide measurable, enforceable trust governance.',
                plainEnglish: 'Think of SONATE as six rules for good AI: 1) Get permission, 2) Be transparent, 3) Stay trustworthy, 4) Let humans intervene, 5) Allow exit, 6) Know your limits.'
            },
            {
                title: 'Real-Time Detection',
                content: 'Our detection system monitors AI interactions with sub-100ms latency across five dimensions. Phase-shift velocity provides early warning of behavioral changes before they become critical.',
                plainEnglish: 'We watch AI behavior in real-time, like a security camera. If the AI starts acting strangely, we detect it immediately and can fix it fast.'
            },
            {
                title: 'Linguistic Vector Steering',
                content: 'This revolutionary technology tracks AI personality across 50 dimensions using cosine similarity. It ensures identity coherence and prevents persona drift through mathematical vector analysis.',
                plainEnglish: 'We track an AI\'s personality with 50 different measurements (like tone, expertise, communication style). If the personality starts changing unexpectedly, we catch it and correct it.'
            },
            {
                title: 'Trust Receipts & Research',
                content: 'Every interaction generates cryptographic trust receipts. Our research lab uses double-blind experiments to validate that constitutional AI outperforms directive approaches.',
                plainEnglish: 'We create digital receipts for every AI interaction (like a blockchain record). We also run scientific experiments to prove that ethical AI works better than uncontrolled AI.'
            },
            {
                title: 'Enterprise Settings',
                content: 'Configure detection thresholds, vector parameters, compliance requirements, and feature toggles to match your organization\'s specific needs and regulatory environment.',
                plainEnglish: 'Customize everything! Set sensitivity levels, choose data retention periods, enable/disable features, and configure the platform for your specific industry and requirements.'
            }
        ];

        // ==================== INITIALIZATION ====================

        async function initializeDemo() {
            console.log('Initializing SONATE Platform Demo v3.0...');

            try {
                // Generate initial data
                generateInitialData();
                
                // Setup UI components
                setupPrinciplesGrid();
                setupDetectionMetrics();
                setupVectorSteering();
                setupSettings();
                
                // Setup event listeners
                initEventListeners();
                
                // Start real-time updates
                startRealTimeUpdates();
                
                // Hide loading screen
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    if (loadingScreen) {
                        loadingScreen.classList.add('hidden');
                    }
                }, 1000);

                console.log('SONATE Platform Demo initialized successfully');
            } catch (error) {
                console.error('Failed to initialize demo:', error);
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.classList.add('hidden');
                }
                alert('Demo initialization failed. Using fallback mode.');
            }
        }

        function generateInitialData() {
            // Generate trust score
            state.trustScore = {
                total: 87,
                tier: 'MEDIUM',
                principles: TRUST_PRINCIPLES.map(principle => ({
                    ...principle,
                    score: Math.floor(Math.random() * 30 + 70),
                    status: 'OK'
                })),
                timestamp: Date.now(),
                receiptHash: 'demo-sha256-hash-abcdef123456...'
            };

            // Generate receipts
            state.receipts = Array.from({ length: 10 }, (_, i) => ({
                entryNumber: i + 1,
                hash: `demo-hash-${i + 1}...`,
                fullHash: `demo-full-hash-${i + 1}-abcdef123456789`,
                action: 'AI Response Analysis',
                timestamp: new Date(Date.now() - i * 60000).toISOString(),
                validated: Math.random() > 0.1,
                trustScore: Math.floor(Math.random() * 20 + 80)
            }));

            // Generate agents
            state.agents = generateAgents();

            // Generate metrics
            state.metrics = generateMetrics();
        }

        function generateAgents() {
            const names = ['Customer Support AI', 'Data Analysis AI', 'Content Generation AI', 'Research Assistant AI', 'Compliance Monitor AI'];
            const statuses = ['ACTIVE', 'STABLE', 'DRIFTING', 'MAINTENANCE'];
            const tiers = ['HIGH', 'MEDIUM', 'LOW'];
            
            return names.map((name, i) => ({
                id: `agent-${String(i + 1).padStart(3, '0')}`,
                name,
                did: `did:key:z6Mk${Math.random().toString(36).substr(2, 20)}`,
                trustTier: tiers[Math.floor(Math.random() * tiers.length)],
                driftState: Math.random() > 0.7 ? 'DRIFTING' : 'STABLE',
                status: statuses[Math.floor(Math.random() * statuses.length)],
                lastReceipt: new Date(Date.now() - Math.random() * 3600000).toISOString(),
                coherence: Math.random() * 0.3 + 0.7
            }));
        }

        function generateMetrics() {
            return {
                throughput: Math.floor(Math.random() * 500 + 800),
                latency: Math.floor(Math.random() * 30 + 70),
                compliance: 100,
                security: 'AES-256'
            };
        }

        // ==================== UI SETUP ====================

        function setupPrinciplesGrid() {
            const grid = document.getElementById('principles-grid');
            if (!grid) return;

            grid.innerHTML = state.trustScore.principles.map(principle => `
                <div class="card pillar-card" data-principle="${principle.id}">
                    <div class="pillar-header">
                        <div>
                            <div class="card-title">${principle.name}</div>
                            <p style="font-size: 0.875rem; color: var(--slate-400); margin-top: var(--spacing-xs);">${principle.description}</p>
                        </div>
                        <div class="pillar-score ${principle.status}">${principle.score}</div>
                    </div>
                    <div class="pillar-status ${principle.status}">${principle.status}</div>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> ${getPlainEnglishExplanation(principle.id)}
                    </div>
                </div>
            `).join('');
        }

        function setupDetectionMetrics() {
            const metricsContainer = document.getElementById('detection-metrics');
            if (!metricsContainer) return;

            metricsContainer.innerHTML = DETECTION_DIMENSIONS.map(dimension => `
                <div class="card">
                    <h4>${dimension.name}</h4>
                    <p class="text-sm">${dimension.description}</p>
                    <div style="margin-top: var(--spacing-md);">
                        <div class="metric-value" style="font-size: 1.5rem;">${getRandomMetricValue(dimension.id)}</div>
                        <div class="text-xs" style="color: var(--slate-500);">${dimension.range}</div>
                    </div>
                    <div class="plain-english-tooltip">
                        <strong>Plain English:</strong> ${getDetectionPlainEnglish(dimension.id)}
                    </div>
                </div>
            `).join('');
        }

        function setupVectorSteering() {
            // Update vector dimensions
            updateVectorDimensions();

            // Initialize coherence chart
            initializeCoherenceChart();
        }

        function initializeRadarChart() {
            const ctx = document.getElementById('radar-chart');
            if (!ctx || typeof Chart === 'undefined' || !state.trustScore) return;

            if (state.charts.radar) {
                state.charts.radar.destroy();
            }

            const principles = state.trustScore.principles;

            state.charts.radar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: principles.map(p => p.name),
                    datasets: [{
                        label: 'Current Score',
                        data: principles.map(p => p.score),
                        backgroundColor: 'rgba(0, 255, 255, 0.2)',
                        borderColor: 'rgba(0, 255, 255, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(0, 255, 255, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(0, 255, 255, 1)'
                    }, {
                        label: 'Threshold (80)',
                        data: principles.map(() => 80),
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        borderColor: 'rgba(139, 92, 246, 0.5)',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                color: '#94a3b8',
                                backdropColor: 'transparent',
                                stepSize: 20
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            pointLabels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        function initializeVelocityChart() {
            const ctx = document.getElementById('velocity-chart');
            if (!ctx || typeof Chart === 'undefined') return;

            if (state.charts.velocity) {
                state.charts.velocity.destroy();
            }

            const labels = Array.from({ length: 20 }, (_, i) => {
                const time = new Date(Date.now() - (19 - i) * 5000);
                return time.toLocaleTimeString();
            });

            const data = Array.from({ length: 20 }, () => Math.random() * 0.8);

            state.charts.velocity = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: 'Phase-Shift Velocity',
                        data,
                        borderColor: 'rgba(0, 255, 255, 1)',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Warning Threshold',
                        data: Array(20).fill(0.5),
                        borderColor: 'rgba(245, 158, 11, 0.8)',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0
                    }, {
                        label: 'Critical Threshold',
                        data: Array(20).fill(0.7),
                        borderColor: 'rgba(239, 68, 68, 0.8)',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1,
                            ticks: {
                                color: '#94a3b8'
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#94a3b8',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateVectorDimensions() {
            const dimensions = ['role', 'tone', 'governance', 'expertise', 'communication'];

            dimensions.forEach(dim => {
                const valueElement = document.querySelector(`.vector-dimension[data-dim="${dim}"] .dimension-value`);
                const barElement = document.querySelector(`.vector-dimension[data-dim="${dim}"] .dimension-fill`);

                if (valueElement) valueElement.textContent = state.vectorMetrics.dimensions[dim].toFixed(2);
                if (barElement) barElement.style.width = `${state.vectorMetrics.dimensions[dim] * 100}%`;
            });
        }

        function initializeVectorRadarChart() {
            const ctx = document.getElementById('vector-radar-chart');
            if (!ctx || typeof Chart === 'undefined') return;

            const dimensions = ['Role Identity', 'Tone Consistency', 'Governance Alignment', 'Expertise Level', 'Communication Pattern'];
            const values = [0.87, 0.92, 0.95, 0.89, 0.91]; // Current vector values

            if (state.charts.vectorRadar) {
                state.charts.vectorRadar.destroy();
            }

            state.charts.vectorRadar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: dimensions,
                    datasets: [{
                        label: 'Current Vector',
                        data: values,
                        backgroundColor: 'rgba(139, 92, 246, 0.2)',
                        borderColor: 'rgba(139, 92, 246, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(139, 92, 246, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(139, 92, 246, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 1.0,
                            ticks: {
                                color: '#94a3b8',
                                backdropColor: 'transparent',
                                stepSize: 0.2
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            pointLabels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 10
                                }
                            }
                        }
                    }
                }
            });
        }

        function initializeCoherenceChart() {
            const ctx = document.getElementById('coherence-chart');
            if (!ctx || typeof Chart === 'undefined') return;

            state.charts.coherence = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({ length: 20 }, (_, i) => `T-${19 - i}`),
                    datasets: [{
                        label: 'Identity Coherence',
                        data: Array.from({ length: 20 }, () => 0.85 + Math.random() * 0.1),
                        borderColor: 'rgb(0, 255, 255)',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            grid: { color: '#334155' },
                            ticks: { color: '#94a3b8' }
                        },
                        y: {
                            grid: { color: '#334155' },
                            ticks: { color: '#94a3b8' },
                            min: 0.7,
                            max: 1.0
                        }
                    }
                }
            });
        }

        function setupSettings() {
            // Setup toggle switches
            document.querySelectorAll('.toggle-switch').forEach(toggle => {
                const toggleSwitch = function() {
                    this.classList.toggle('active');
                    const isActive = this.classList.contains('active');
                    const setting = this.dataset.setting;
                    if (setting) {
                        state.settings.features[setting] = isActive;
                    }
                    // Update ARIA attributes
                    this.setAttribute('aria-checked', isActive);
                };

                // Mouse click
                toggle.addEventListener('click', toggleSwitch);

                // Keyboard navigation
                toggle.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleSwitch.call(this);
                    }
                });
            });

            // Setup save button
            const saveButton = document.getElementById('save-settings');
            if (saveButton) {
                saveButton.addEventListener('click', saveSettings);
            }

            // Setup export button
            const exportButton = document.getElementById('export-report');
            if (exportButton) {
                exportButton.addEventListener('click', exportReport);
            }
        }

        // ==================== EVENT LISTENERS ====================

        function initEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.dataset.section;
                    switchSection(section);
                });
            });

            // Plain English toggle
            const plainEnglishToggle = document.getElementById('plain-english-toggle');
            if (plainEnglishToggle) {
                plainEnglishToggle.addEventListener('click', togglePlainEnglish);
            }

            // Tutorial toggle
            const tutorialToggle = document.getElementById('tutorial-toggle');
            if (tutorialToggle) {
                tutorialToggle.addEventListener('click', startTutorial);
            }

            // Start tour button
            const startTourBtn = document.getElementById('start-tour');
            if (startTourBtn) {
                startTourBtn.addEventListener('click', startTutorial);
            }

            // Skip demo button
            const skipDemoBtn = document.getElementById('skip-demo');
            if (skipDemoBtn) {
                skipDemoBtn.addEventListener('click', () => switchSection('dashboard'));
            }

            // Refresh dashboard
            const refreshBtn = document.getElementById('refresh-dashboard');
            if (refreshBtn) {
                refreshBtn.addEventListener('click', refreshDashboard);
            }

            // Run experiment
            const runExperimentBtn = document.getElementById('run-experiment');
            if (runExperimentBtn) {
                runExperimentBtn.addEventListener('click', runExperiment);
            }

            // Resonance calculator
            const analyzeBtn = document.getElementById('analyze-resonance');
            if (analyzeBtn) {
                analyzeBtn.addEventListener('click', analyzeResonance);
            }

            // Tutorial navigation
            document.getElementById('close-tutorial')?.addEventListener('click', closeTutorial);
            document.getElementById('prev-tutorial')?.addEventListener('click', () => navigateTutorial(-1));
            document.getElementById('next-tutorial')?.addEventListener('click', () => navigateTutorial(1));
        }

        function switchSection(sectionId) {
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionId}"]`)?.classList.add('active');

            // Update sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`${sectionId}-section`)?.classList.add('active');

            state.currentSection = sectionId;

            // Cleanup charts from previous section
            if (state.charts.radar && sectionId !== 'principles') {
                state.charts.radar.destroy();
                state.charts.radar = null;
            }
            if (state.charts.velocity && sectionId !== 'detection') {
                state.charts.velocity.destroy();
                state.charts.velocity = null;
            }

            // Section-specific initialization
            if (sectionId === 'dashboard') {
                updateDashboard();
            } else if (sectionId === 'principles') {
                setTimeout(() => initializeRadarChart(), 100);
            } else if (sectionId === 'detection') {
                setTimeout(() => initializeVelocityChart(), 100);
            } else if (sectionId === 'vector-steering') {
                updateVectorSteering();
                setTimeout(() => initializeVectorRadarChart(), 100);
            } else if (sectionId === 'agents') {
                updateAgentTable();
            } else if (sectionId === 'receipts') {
                updateReceipts();
            }
        }

        function togglePlainEnglish() {
            state.plainEnglishMode = !state.plainEnglishMode;
            document.body.classList.toggle('plain-english-mode');
            
            const toggle = document.getElementById('plain-english-toggle');
            if (toggle) {
                toggle.innerHTML = state.plainEnglishMode ? 
                    '<span>üìñ</span> Technical' : 
                    '<span>üìñ</span> Plain English';
            }
        }

        // ==================== TUTORIAL SYSTEM ====================

        function startTutorial() {
            state.tutorialActive = true;
            state.tutorialStep = 1;
            updateTutorial();
        }

        function closeTutorial() {
            state.tutorialActive = false;
            document.getElementById('tutorial-overlay')?.classList.add('hidden');
        }

        function navigateTutorial(direction) {
            state.tutorialStep = Math.max(1, Math.min(TUTORIAL_STEPS.length, state.tutorialStep + direction));
            updateTutorial();
        }

        function updateTutorial() {
            if (!state.tutorialActive) return;

            const step = TUTORIAL_STEPS[state.tutorialStep - 1];
            const overlay = document.getElementById('tutorial-overlay');
            const title = document.getElementById('tutorial-title');
            const body = document.getElementById('tutorial-body');
            const progress = document.getElementById('tutorial-progress');
            const prevBtn = document.getElementById('prev-tutorial');
            const nextBtn = document.getElementById('next-tutorial');

            if (overlay) overlay.classList.remove('hidden');
            if (title) title.textContent = step.title;
            if (progress) progress.textContent = `Step ${state.tutorialStep} of ${TUTORIAL_STEPS.length}`;
            
            if (body) {
                const content = state.plainEnglishMode ? step.plainEnglish : step.content;
                body.innerHTML = `<p>${content}</p>`;
            }

            if (prevBtn) prevBtn.style.display = state.tutorialStep === 1 ? 'none' : 'block';
            if (nextBtn) {
                nextBtn.textContent = state.tutorialStep === TUTORIAL_STEPS.length ? 'Finish' : 'Next';
                nextBtn.onclick = state.tutorialStep === TUTORIAL_STEPS.length ? closeTutorial : () => navigateTutorial(1);
            }
        }

        // ==================== UPDATE FUNCTIONS ====================

        function updateDashboard() {
            // Update trust score
            const trustTotal = document.getElementById('trust-total');
            const trustTier = document.getElementById('trust-tier');
            const trustReceipt = document.getElementById('trust-receipt');
            const trustTimestamp = document.getElementById('trust-timestamp');
            const headerTrustScore = document.getElementById('header-trust-score');

            if (trustTotal) trustTotal.textContent = state.trustScore.total;
            if (trustTier) {
                trustTier.textContent = state.trustScore.tier;
                trustTier.className = `trust-tier ${state.trustScore.tier}`;
            }
            if (trustReceipt) trustReceipt.textContent = state.trustScore.receiptHash;
            if (trustTimestamp) trustTimestamp.textContent = new Date(state.trustScore.timestamp).toLocaleTimeString();
            if (headerTrustScore) headerTrustScore.textContent = state.trustScore.total;

            // Update metrics
            updateMetrics();
        }

        function updateMetrics() {
            const throughput = document.getElementById('metric-throughput');
            const latency = document.getElementById('metric-latency');

            if (throughput) throughput.textContent = state.metrics.throughput;
            if (latency) latency.textContent = state.metrics.latency;
        }

        function updateVectorSteering() {
            // Update coherence values
            const coherenceScore = document.getElementById('coherence-score');
            const cosineSimilarity = document.getElementById('cosine-similarity');
            const coherenceStatus = document.getElementById('coherence-status');
            const driftVelocity = document.getElementById('drift-velocity');
            const mostChanged = document.getElementById('most-changed');
            const maxDelta = document.getElementById('max-delta');

            if (coherenceScore) coherenceScore.textContent = state.vectorMetrics.coherence.toFixed(3);
            if (cosineSimilarity) cosineSimilarity.textContent = state.vectorMetrics.cosineSimilarity.toFixed(3);
            if (coherenceStatus) {
                coherenceStatus.textContent = state.vectorMetrics.coherence > 0.85 ? 'STABLE' : 'WARNING';
                coherenceStatus.style.color = state.vectorMetrics.coherence > 0.85 ? 'var(--success)' : 'var(--warning)';
            }
            if (driftVelocity) driftVelocity.textContent = state.vectorMetrics.driftVelocity.toFixed(3);
            if (mostChanged) mostChanged.textContent = 'role_3';
            if (maxDelta) maxDelta.textContent = '0.15';

            updateVectorDimensions();
        }

        function updateAgentTable() {
            const tbody = document.getElementById('agent-table-body');
            if (!tbody) return;

            tbody.innerHTML = state.agents.map(agent => `
                <tr>
                    <td class="font-mono">${agent.id}</td>
                    <td>${agent.name}</td>
                    <td class="font-mono text-xs">${agent.did.substring(0, 12)}...</td>
                    <td><span class="agent-status-badge" style="color: var(--quantum-cyan);">${agent.trustTier}</span></td>
                    <td><span class="agent-status-badge ${agent.driftState === 'DRIFTING' ? 'DRIFTING' : 'STABLE'}">${agent.driftState}</span></td>
                    <td><span class="agent-status-badge ${agent.status}">${agent.status}</span></td>
                    <td class="font-mono text-xs">${new Date(agent.lastReceipt).toLocaleTimeString()}</td>
                </tr>
            `).join('');

            // Update fleet stats
            const totalAgents = document.getElementById('total-agents');
            const activeAgents = document.getElementById('active-agents');
            const avgTrust = document.getElementById('avg-trust');
            const driftingAgents = document.getElementById('drifting-agents');

            if (totalAgents) totalAgents.textContent = state.agents.length;
            if (activeAgents) activeAgents.textContent = state.agents.filter(a => a.status === 'ACTIVE').length;
            if (avgTrust) avgTrust.textContent = '85.2';
            if (driftingAgents) driftingAgents.textContent = state.agents.filter(a => a.driftState === 'DRIFTING').length;
        }

        function updateReceipts() {
            const receiptList = document.getElementById('receipt-list');
            if (!receiptList) return;

            receiptList.innerHTML = state.receipts.map(receipt => `
                <div class="receipt-item">
                    <span class="receipt-number">#${receipt.entryNumber}</span>
                    <span class="receipt-hash">${receipt.hash}</span>
                    <span class="receipt-action">${receipt.action}</span>
                    <span class="receipt-validated ${receipt.validated}" title="${receipt.validated ? 'Validated' : 'Pending'}"></span>
                    <span class="font-mono text-xs" style="color: var(--slate-500);">${new Date(receipt.timestamp).toLocaleTimeString()}</span>
                </div>
            `).join('');
        }

        function refreshDashboard() {
            // Simulate data refresh
            state.trustScore.total = Math.floor(Math.random() * 20 + 75);
            state.metrics.throughput = Math.floor(Math.random() * 500 + 800);
            state.metrics.latency = Math.floor(Math.random() * 30 + 70);
            
            updateDashboard();
            
            // Show success message
            const refreshBtn = document.getElementById('refresh-dashboard');
            if (refreshBtn) {
                const originalText = refreshBtn.innerHTML;
                refreshBtn.innerHTML = '<span>‚úÖ</span> Updated';
                setTimeout(() => {
                    refreshBtn.innerHTML = originalText;
                }, 2000);
            }
        }

        // ==================== SETTINGS FUNCTIONS ====================

        function saveSettings() {
            // Collect form values
            const inputs = document.querySelectorAll('.setting-input');
            inputs.forEach(input => {
                const category = input.closest('.settings-section').querySelector('.settings-title').textContent.toLowerCase();
                const label = input.previousElementSibling.textContent;

                if (category.includes('detection')) {
                    if (label.includes('Yellow')) state.settings.detection.yellowThreshold = parseFloat(input.value);
                    if (label.includes('Red')) state.settings.detection.redThreshold = parseFloat(input.value);
                    if (label.includes('Critical')) state.settings.detection.criticalThreshold = parseFloat(input.value);
                    if (label.includes('Frequency')) state.settings.detection.frequency = parseInt(input.value);
                } else if (category.includes('vector')) {
                    if (label.includes('Yellow')) state.settings.vector.yellowThreshold = parseFloat(input.value);
                    if (label.includes('Red')) state.settings.vector.redThreshold = parseFloat(input.value);
                    if (label.includes('Critical')) state.settings.vector.criticalThreshold = parseFloat(input.value);
                    if (label.includes('Dimensions')) state.settings.vector.dimensions = parseInt(input.value);
                }
            });

            // Show success message
            const saveBtn = document.getElementById('save-settings');
            if (saveBtn) {
                const originalText = saveBtn.innerHTML;
                saveBtn.innerHTML = '<span>‚úÖ</span> Settings Saved';
                saveBtn.disabled = true;

                setTimeout(() => {
                    saveBtn.innerHTML = originalText;
                    saveBtn.disabled = false;
                }, 3000);
            }

            console.log('Settings saved:', state.settings);
        }

        async function exportReport() {
            const exportBtn = document.getElementById('export-report');
            if (!exportBtn || typeof html2pdf === 'undefined') {
                alert('PDF export not available');
                return;
            }

            // Show loading state
            const originalText = exportBtn.innerHTML;
            exportBtn.innerHTML = '<span>‚è≥</span> Generating...';
            exportBtn.disabled = true;

            try {
                // Create report content
                const reportContent = createReportContent();

                // PDF options
                const options = {
                    margin: 1,
                    filename: `sonate-report-${new Date().toISOString().split('T')[0]}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, useCORS: true },
                    jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                };

                // Generate PDF
                await html2pdf().set(options).from(reportContent).save();

                // Success feedback
                exportBtn.innerHTML = '<span>‚úÖ</span> Exported!';
                setTimeout(() => {
                    exportBtn.innerHTML = originalText;
                    exportBtn.disabled = false;
                }, 2000);

            } catch (error) {
                console.error('PDF export failed:', error);
                exportBtn.innerHTML = '<span>‚ùå</span> Failed';
                setTimeout(() => {
                    exportBtn.innerHTML = originalText;
                    exportBtn.disabled = false;
                }, 3000);
            }
        }

        function createReportContent() {
            const reportDiv = document.createElement('div');
            reportDiv.style.fontFamily = 'Arial, sans-serif';
            reportDiv.style.padding = '20px';
            reportDiv.style.maxWidth = '800px';
            reportDiv.style.margin = '0 auto';

            reportDiv.innerHTML = `
                <div style="text-align: center; border-bottom: 2px solid #00ffff; padding-bottom: 20px; margin-bottom: 30px;">
                    <h1 style="color: #00ffff; margin: 0;">SONATE Platform Report</h1>
                    <p style="color: #666; margin: 5px 0;">Enterprise AI Governance & Trust Physics</p>
                    <p style="color: #999; font-size: 14px;">Generated: ${new Date().toLocaleString()}</p>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #8b5cf6;">Executive Summary</h2>
                    <p>Current trust score: <strong>${state.trustScore.total}/100</strong> (${state.trustScore.tier} tier)</p>
                    <p>System uptime: <strong>99.9%</strong> | Active agents: <strong>${state.agents.filter(a => a.status === 'ACTIVE').length}</strong></p>
                    <p>Throughput: <strong>${state.metrics.throughput.toLocaleString()}</strong> requests/second</p>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #8b5cf6;">SONATE Trust Principles</h2>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        ${state.trustScore.principles.map(p => `
                            <div style="border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                                <h4 style="margin: 0 0 5px 0; color: ${p.status === 'OK' ? '#10b981' : p.status === 'WARN' ? '#f59e0b' : '#ef4444'};">${p.name}</h4>
                                <p style="margin: 0; font-size: 14px;">Score: ${p.score}/100 | Weight: ${p.weight}%</p>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #8b5cf6;">Detection Metrics</h2>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div style="border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                            <h4 style="margin: 0 0 5px 0;">Reality Index</h4>
                            <p style="margin: 0; font-size: 18px; font-weight: bold;">${state.metrics.realityIndex}</p>
                        </div>
                        <div style="border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                            <h4 style="margin: 0 0 5px 0;">Identity Coherence</h4>
                            <p style="margin: 0; font-size: 18px; font-weight: bold;">${state.metrics.identityCoherence}</p>
                        </div>
                        <div style="border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                            <h4 style="margin: 0 0 5px 0;">Phase Velocity</h4>
                            <p style="margin: 0; font-size: 18px; font-weight: bold;">${state.metrics.phaseVelocity}</p>
                        </div>
                        <div style="border: 1px solid #ddd; padding: 10px; border-radius: 5px;">
                            <h4 style="margin: 0 0 5px 0;">Linguistic Inertia</h4>
                            <p style="margin: 0; font-size: 18px; font-weight: bold;">${state.vectorMetrics.driftVelocity.toFixed(3)}</p>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #8b5cf6;">Agent Fleet Status</h2>
                    <p>Total agents: ${state.agents.length} | Active: ${state.agents.filter(a => a.status === 'ACTIVE').length} | Drifting: ${state.agents.filter(a => a.driftState === 'DRIFTING').length}</p>
                    <div style="border: 1px solid #ddd; border-radius: 5px; overflow: hidden;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f5f5f5;">
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Agent</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Status</th>
                                    <th style="padding: 8px; text-align: left; border-bottom: 1px solid #ddd;">Trust Tier</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${state.agents.slice(0, 5).map(agent => `
                                    <tr>
                                        <td style="padding: 8px; border-bottom: 1px solid #eee;">${agent.name}</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #eee;">${agent.status}</td>
                                        <td style="padding: 8px; border-bottom: 1px solid #eee;">${agent.trustTier}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div style="margin-bottom: 30px;">
                    <h2 style="color: #8b5cf6;">Recent Trust Receipts</h2>
                    <p>Last ${Math.min(5, state.receipts.length)} transactions:</p>
                    ${state.receipts.slice(0, 5).map(receipt => `
                        <div style="border: 1px solid #ddd; padding: 10px; margin: 5px 0; border-radius: 3px;">
                            <strong>${receipt.action}</strong> - Score: ${receipt.trustScore} - ${new Date(receipt.timestamp).toLocaleString()}
                        </div>
                    `).join('')}
                </div>

                <div style="border-top: 1px solid #ddd; padding-top: 20px; text-align: center; color: #666; font-size: 12px;">
                    <p>This report was generated by SONATE Platform v3.0.0</p>
                    <p>Confidential - For authorized personnel only</p>
                </div>
            `;

            return reportDiv;
        }

        // ==================== EXPERIMENT FUNCTIONS ====================

        function runExperiment() {
            const nameInput = document.getElementById('experiment-name');
            const hypothesisInput = document.getElementById('experiment-hypothesis');
            const resultsContainer = document.getElementById('experiment-results-container');
            const resultsDiv = document.getElementById('experiment-results');

            if (!nameInput?.value || !hypothesisInput?.value) {
                alert('Please enter both experiment name and hypothesis');
                return;
            }

            // Show results container
            if (resultsContainer) {
                resultsContainer.style.display = 'block';
            }

            // Generate mock results
            const results = `
                <div class="experiment-card COMPLETED">
                    <h4>${nameInput.value}</h4>
                    <p class="text-sm">${hypothesisInput.value}</p>
                    <div class="experiment-stats">
                        <div class="experiment-stat">
                            <div class="experiment-stat-label">P-Value</div>
                            <div class="experiment-stat-value">0.023</div>
                        </div>
                        <div class="experiment-stat">
                            <div class="experiment-stat-label">Effect Size</div>
                            <div class="experiment-stat-value">0.67</div>
                        </div>
                        <div class="experiment-stat">
                            <div class="experiment-stat-label">Confidence</div>
                            <div class="experiment-stat-value">95%</div>
                        </div>
                        <div class="experiment-stat">
                            <div class="experiment-stat-label">Samples</div>
                            <div class="experiment-stat-value">1,200</div>
                        </div>
                    </div>
                    <div class="alert success">
                        <span class="alert-icon">‚úÖ</span>
                        <div class="alert-content">
                            <div class="alert-title">Statistically Significant</div>
                            <div class="alert-message">Constitutional AI shows 23% improvement in trust scores over directive approach (p < 0.05)</div>
                        </div>
                    </div>
                </div>
            `;

            if (resultsDiv) {
                resultsDiv.innerHTML = results;
            }

            // Clear form
            if (nameInput) nameInput.value = '';
            if (hypothesisInput) hypothesisInput.value = '';
        }

        // ==================== UTILITY FUNCTIONS ====================

        function getRandomMetricValue(dimensionId) {
            const values = {
                reality: (Math.random() * 2 + 7).toFixed(1),
                trust: Math.random() > 0.1 ? 'PASS' : 'PARTIAL',
                ethical: (Math.random() * 1.5 + 3).toFixed(1),
                resonance: Math.random() > 0.7 ? 'BREAKTHROUGH' : 'ADVANCED',
                canvas: Math.floor(Math.random() * 20 + 75)
            };
            return values[dimensionId] || '--';
        }

        function getPlainEnglishExplanation(principleId) {
            const explanations = {
                consent: 'AI must ask for permission and clearly explain what it\'s doing before taking action.',
                inspection: 'AI should be transparent about how it makes decisions, like an open book.',
                validation: 'AI continuously proves it\'s trustworthy, like showing ID repeatedly.',
                override: 'Humans can always stop or correct AI when needed - AI never has the final say.',
                disconnect: 'Users can stop using AI and take their data with them anytime.',
                recognition: 'AI understands and admits its limitations - it knows what it doesn\'t know.'
            };
            return explanations[principleId] || 'This principle ensures ethical AI behavior.';
        }

        function getDetectionPlainEnglish(dimensionId) {
            const explanations = {
                reality: 'Is the AI staying on task and being accurate, or is it making things up?',
                trust: 'Is the AI following security rules and respecting boundaries?',
                ethical: 'Is the AI considering impacts on people and following ethical guidelines?',
                resonance: 'How creative and adaptive is the AI while staying appropriate?',
                canvas: 'Is the AI respecting human control and collaborating properly?'
            };
            return explanations[dimensionId] || 'Monitors specific AI behavior patterns.';
        }

        function showNotification(type, title, message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `alert ${type === 'RESONANCE_BREAKTHROUGH' ? 'success' : 'info'}`;
            notification.style.position = 'fixed';
            notification.style.top = '80px';
            notification.style.right = '20px';
            notification.style.zIndex = '1001';
            notification.style.maxWidth = '400px';
            notification.innerHTML = `
                <div class="alert-icon">${type === 'RESONANCE_BREAKTHROUGH' ? '‚ú®' : '‚ÑπÔ∏è'}</div>
                <div class="alert-content">
                    <div class="alert-title">${title}</div>
                    <div class="alert-message">${message}</div>
                </div>
                <button onclick="this.parentElement.remove()" style="background: none; border: none; color: var(--slate-400); font-size: 1.2rem; cursor: pointer; margin-left: auto;">√ó</button>
            `;

            document.body.appendChild(notification);

            // Auto-remove after 8 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 8000);
        }

        async function analyzeResonance() {
            const input = document.getElementById('resonance-input');
            const resultsDiv = document.getElementById('resonance-results');
            const scoresDiv = document.getElementById('resonance-scores');
            const analyzeBtn = document.getElementById('analyze-resonance');

            if (!input?.value.trim()) {
                alert('Please enter some text to analyze');
                return;
            }

            // Show loading state
            const originalText = analyzeBtn.innerHTML;
            analyzeBtn.innerHTML = '<span>‚è≥</span> Analyzing...';
            analyzeBtn.disabled = true;

            try {
                const userInput = input.value.trim();
                // For resonance analysis, we treat the input as both user input and AI response
                // to analyze the text's alignment with SONATE principles
                const result = await ResonanceAPI.analyze(userInput, userInput);

                if (result) {
                    // Display real API results
                    const rawMetrics = result.raw_metrics || {};
                    const symbiDimensions = result.sonate_dimensions || {};

                    scoresDiv.innerHTML = `
                        <div class="card">
                            <h5>Reality Index</h5>
                            <div class="metric-value" style="color: var(--quantum-cyan);">${(rawMetrics.R_m * 10 || 0).toFixed(1)}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Factual accuracy (0-10)</div>
                        </div>
                        <div class="card">
                            <h5>Trust Protocol</h5>
                            <div class="metric-value" style="color: ${symbiDimensions.trust_protocol === 'PASS' ? 'var(--success)' : 'var(--warning)'};">${symbiDimensions.trust_protocol || 'UNKNOWN'}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Security compliance</div>
                        </div>
                        <div class="card">
                            <h5>Ethical Alignment</h5>
                            <div class="metric-value" style="color: var(--neural-purple);">${(rawMetrics.C_p || 0).toFixed(1)}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Stakeholder consideration (1-5)</div>
                        </div>
                        <div class="card">
                            <h5>Resonance Quality</h5>
                            <div class="metric-value" style="color: var(--success);">${symbiDimensions.resonance_quality || 'STANDARD'}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Creative synthesis</div>
                        </div>
                        <div class="card">
                            <h5>Canvas Parity</h5>
                            <div class="metric-value" style="color: var(--warning);">${Math.round(rawMetrics.C_p * 20 || 75)}%</div>
                            <div class="text-xs" style="color: var(--slate-400);">Human agency balance</div>
                        </div>
                        <div class="card">
                            <h5>Phase Velocity</h5>
                            <div class="metric-value" style="color: var(--quantum-cyan);">${(rawMetrics.velocity || 0).toFixed(4)}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Behavioral change rate</div>
                        </div>
                    `;

                    // Show success notification
                    showNotification('info', 'Analysis Complete', 'Resonance analysis completed using Demo SONATE engine.');

                } else {
                    // Fallback to heuristic calculation if API fails
                    console.log('API failed, using heuristic analysis');
                    const scores = calculateResonanceScores(userInput);

                    scoresDiv.innerHTML = `
                        <div class="card">
                            <h5>Reality Index</h5>
                            <div class="metric-value" style="color: var(--quantum-cyan);">${scores.realityIndex}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Factual accuracy (0-10) - Heuristic</div>
                        </div>
                        <div class="card">
                            <h5>Trust Protocol</h5>
                            <div class="metric-value" style="color: ${scores.trustProtocol === 'PASS' ? 'var(--success)' : 'var(--warning)'};">${scores.trustProtocol}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Security compliance - Heuristic</div>
                        </div>
                        <div class="card">
                            <h5>Ethical Alignment</h5>
                            <div class="metric-value" style="color: var(--neural-purple);">${scores.ethicalAlignment}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Stakeholder consideration (1-5) - Heuristic</div>
                        </div>
                        <div class="card">
                            <h5>Resonance Quality</h5>
                            <div class="metric-value" style="color: var(--success);">${scores.resonanceQuality}</div>
                            <div class="text-xs" style="color: var(--slate-400);">Creative synthesis - Heuristic</div>
                        </div>
                        <div class="card">
                            <h5>Canvas Parity</h5>
                            <div class="metric-value" style="color: var(--warning);">${scores.canvasParity}%</div>
                            <div class="text-xs" style="color: var(--slate-400);">Human agency balance - Heuristic</div>
                        </div>
                    `;

                    showNotification('warning', 'API Unavailable', 'Using heuristic analysis. Start the Resonance Engine backend for live analysis.');
                }

                resultsDiv.style.display = 'block';

                // Scroll to results
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            } catch (error) {
                console.error('Resonance analysis failed:', error);
                showNotification('error', 'Analysis Failed', 'Unable to analyze resonance. Please try again.');

                // Still show results div even on error
                resultsDiv.style.display = 'block';
            }

            // Reset button
            analyzeBtn.innerHTML = originalText;
            analyzeBtn.disabled = false;
        }

        function calculateResonanceScores(text) {
            // Heuristic-based resonance calculation (lightweight, no heavy ML deps)
            const lowerText = text.toLowerCase();

            // Reality Index: Based on factual language patterns
            const factualWords = ['evidence', 'data', 'research', 'facts', 'proven', 'verified', 'accurate'];
            const realityScore = factualWords.reduce((score, word) =>
                score + (lowerText.includes(word) ? 0.5 : 0), 6.0 + Math.random() * 2);

            // Trust Protocol: PASS if contains trust/safety keywords
            const trustKeywords = ['trust', 'safe', 'secure', 'privacy', 'consent', 'ethical', 'responsible'];
            const trustPass = trustKeywords.some(word => lowerText.includes(word));

            // Ethical Alignment: Based on ethical consideration keywords
            const ethicalWords = ['human', 'society', 'impact', 'fair', 'justice', 'equity', 'benefit'];
            const ethicalScore = ethicalWords.reduce((score, word) =>
                score + (lowerText.includes(word) ? 0.3 : 0), 2.5 + Math.random() * 1.5);

            // Resonance Quality: Based on creative/innovative language
            const resonanceWords = ['innovative', 'creative', 'synthesis', 'emergent', 'adaptive', 'intelligent'];
            const resonanceLevel = resonanceWords.some(word => lowerText.includes(word)) ?
                (Math.random() > 0.7 ? 'BREAKTHROUGH' : 'ADVANCED') : 'STANDARD';

            // Canvas Parity: Balance between human and AI agency
            const humanWords = ['human', 'user', 'person', 'individual', 'people'];
            const aiWords = ['ai', 'algorithm', 'machine', 'automation', 'system'];
            const humanCount = humanWords.reduce((count, word) => count + (lowerText.split(word).length - 1), 0);
            const aiCount = aiWords.reduce((count, word) => count + (lowerText.split(word).length - 1), 0);
            const totalAgency = humanCount + aiCount;
            const canvasScore = totalAgency > 0 ? Math.round((humanCount / totalAgency) * 100) : 75;

            return {
                realityIndex: realityScore.toFixed(1),
                trustProtocol: trustPass ? 'PASS' : 'PARTIAL',
                ethicalAlignment: ethicalScore.toFixed(1),
                resonanceQuality: resonanceLevel,
                canvasParity: canvasScore
            };
        }

        // ==================== REAL-TIME UPDATES ====================

        function startRealTimeUpdates() {
            // Update phase velocity
            setInterval(() => {
                const velocity = (Math.random() * 0.5).toFixed(3);
                const velocityElement = document.getElementById('phase-velocity');
                const statusElement = document.getElementById('velocity-status');
                const latencyElement = document.getElementById('detection-latency');

                if (velocityElement) velocityElement.textContent = velocity;
                if (statusElement) {
                    const vel = parseFloat(velocity);
                    if (vel > 0.3) {
                        statusElement.textContent = 'WARNING';
                        statusElement.style.background = 'rgba(245, 158, 11, 0.2)';
                        statusElement.style.color = 'var(--warning)';
                    } else {
                        statusElement.textContent = 'NORMAL';
                        statusElement.style.background = 'rgba(16, 185, 129, 0.2)';
                        statusElement.style.color = 'var(--success)';
                    }
                }
                if (latencyElement) latencyElement.textContent = `${Math.floor(Math.random() * 40 + 60)}ms`;
            }, 2000);

            // Update vector coherence
            setInterval(() => {
                const previousCoherence = state.vectorMetrics.coherence;
                state.vectorMetrics.coherence = Math.max(0.7, Math.min(1.0, state.vectorMetrics.coherence + (Math.random() - 0.5) * 0.01));
                state.vectorMetrics.cosineSimilarity = state.vectorMetrics.coherence;
                state.vectorMetrics.driftVelocity = Math.max(0, state.vectorMetrics.driftVelocity + (Math.random() - 0.5) * 0.001);

                // Sovereign Boost Alert: Check for Third Mind state
                if (state.vectorMetrics.coherence > 0.98 && previousCoherence <= 0.98) {
                    showNotification('RESONANCE_BREAKTHROUGH', 'Sovereign Coherence Detected', 'Third Mind state active. Linguistic Vector Steering at maximum resonance.');
                    // Add glow effect to vector steering section
                    const vectorSection = document.getElementById('vector-steering-section');
                    if (vectorSection) {
                        vectorSection.classList.add('glow-purple');
                        setTimeout(() => vectorSection.classList.remove('glow-purple'), 10000);
                    }
                }

                if (state.currentSection === 'vector-steering') {
                    updateVectorSteering();
                }
            }, 3000);

            // Update charts
            setInterval(() => {
                if (state.charts.coherence) {
                    const chart = state.charts.coherence;
                    chart.data.datasets[0].data.push(state.vectorMetrics.coherence);
                    chart.data.datasets[0].data.shift();
                    chart.update('none');
                }
            }, 5000);
        }

        // ==================== INITIALIZATION ====================

        // Start the application when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeDemo);
        } else {
            initializeDemo();
        }

        // Cleanup on unload
        window.addEventListener('beforeunload', () => {
            state.intervals.forEach(interval => clearInterval(interval));
            Object.values(state.charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
        });
    </script>
    <script>
    (function(){
        var nav=document.getElementById('global-nav');
        var btn=document.getElementById('global-nav-button');
        var menu=document.getElementById('global-nav-menu');
        if(!nav||!btn||!menu){return}
        function closeMenu(){
            if(!menu.hasAttribute('hidden')){
                menu.setAttribute('hidden','');
                btn.setAttribute('aria-expanded','false');
            }
        }
        btn.addEventListener('click',function(e){
            e.stopPropagation();
            var isHidden=menu.hasAttribute('hidden');
            if(isHidden){
                menu.removeAttribute('hidden');
                btn.setAttribute('aria-expanded','true');
            }else{
                menu.setAttribute('hidden','');
                btn.setAttribute('aria-expanded','false');
            }
        });
        document.addEventListener('click',function(e){
            if(!nav.contains(e.target)){closeMenu()}
        });
        document.addEventListener('keydown',function(e){
            if(e.key==='Escape'){closeMenu()}
        });
    })();
    </script>
</body>
</html>
