<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SONATE Platform - Enterprise AI Governance with Constitutional Trust">
    <title>SONATE Platform - Enterprise AI You Can Trust</title>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <style>
        /* ==================== CSS VARIABLES & RESET ==================== */
        :root {
            /* Colors - Quantum Cyan & Neural Purple Palette */
            --quantum-cyan: #00ffff;
            --neural-purple: #8b5cf6;
            --dark-matter: #0f172a;
            --slate-950: #020617;
            --slate-900: #0f172a;
            --slate-800: #1e293b;
            --slate-700: #334155;
            --slate-600: #475569;
            --slate-400: #94a3b8;
            --slate-300: #cbd5e1;
            --slate-100: #f1f5f9;
            
            /* Semantic Colors */
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #3b82f6;
            
            /* Typography */
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            
            /* Spacing */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-glow: 0 0 20px rgba(0, 255, 255, 0.3);
            
            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-base: 300ms ease;
            --transition-slow: 500ms ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: var(--font-sans);
            background: var(--slate-950);
            color: var(--slate-100);
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* ==================== UTILITY CLASSES ==================== */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
        }
        
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-2 { gap: var(--spacing-sm); }
        .gap-4 { gap: var(--spacing-md); }
        .gap-6 { gap: var(--spacing-lg); }
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        
        /* ==================== TYPOGRAPHY ==================== */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            color: var(--slate-100);
        }
        
        h1 { font-size: 3rem; margin-bottom: var(--spacing-lg); }
        h2 { font-size: 2rem; margin-bottom: var(--spacing-md); }
        h3 { font-size: 1.5rem; margin-bottom: var(--spacing-md); }
        h4 { font-size: 1.25rem; margin-bottom: var(--spacing-sm); }
        
        p { margin-bottom: var(--spacing-md); color: var(--slate-400); }
        
        .font-mono { font-family: var(--font-mono); }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        
        /* ==================== BUTTONS ==================== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all var(--transition-base);
            text-decoration: none;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--quantum-cyan), var(--neural-purple));
            color: var(--dark-matter);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }
        
        .btn-secondary {
            background: rgba(0, 255, 255, 0.1);
            color: var(--quantum-cyan);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }
        
        .btn-secondary:hover {
            background: rgba(0, 255, 255, 0.2);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* ==================== CARDS ==================== */
        .card {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid var(--slate-800);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            backdrop-filter: blur(10px);
            transition: all var(--transition-base);
        }
        
        .card:hover {
            border-color: rgba(0, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.1);
        }
        
        .card-header {
            margin-bottom: var(--spacing-md);
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--slate-100);
        }
        
        /* ==================== LAYOUT ==================== */
        .grid {
            display: grid;
            gap: var(--spacing-lg);
        }
        
        .grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
        .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        
        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
            .md\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
            .md\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        }
        
        @media (min-width: 1024px) {
            .lg\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
            .lg\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
        }
        
        /* ==================== HEADER ==================== */
        .header {
            background: var(--slate-900);
            border-bottom: 1px solid var(--slate-800);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--spacing-md) 0;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
        }
        
        .logo-text h1 {
            font-size: 1.25rem;
            margin: 0;
        }
        
        .logo-text p {
            font-size: 0.75rem;
            color: var(--slate-400);
            margin: 0;
        }
        
        .header-status {
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.875rem;
            color: var(--slate-400);
        }
        
        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* ==================== NAVIGATION ==================== */
        .nav {
            background: rgba(15, 23, 42, 0.5);
            border-bottom: 1px solid var(--slate-800);
            overflow-x: auto;
        }
        
        .nav-items {
            display: flex;
            gap: var(--spacing-sm);
            padding: 0;
            list-style: none;
        }
        
        .nav-item {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 2px solid transparent;
            cursor: pointer;
            transition: all var(--transition-base);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            color: var(--slate-400);
            font-weight: 500;
            font-size: 0.875rem;
        }
        
        .nav-item:hover {
            color: var(--slate-300);
            border-bottom-color: var(--slate-600);
        }
        
        .nav-item.active {
            color: var(--quantum-cyan);
            border-bottom-color: var(--quantum-cyan);
        }
        
        /* ==================== MAIN CONTENT ==================== */
        .main {
            padding: var(--spacing-2xl) 0;
            min-height: calc(100vh - 200px);
        }
        
        .section {
            display: none;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ==================== HERO SECTION ==================== */
        .hero {
            padding: var(--spacing-2xl) 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: -1;
            opacity: 0.3;
        }
        
        .hero-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            background: linear-gradient(135deg, var(--quantum-cyan), var(--neural-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--spacing-lg);
        }
        
        .hero-subtitle {
            font-size: 1.25rem;
            color: var(--slate-300);
            max-width: 800px;
            margin: 0 auto var(--spacing-2xl);
        }
        
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
            margin-top: var(--spacing-2xl);
        }
        
        .stat-card {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--quantum-cyan);
            font-family: var(--font-mono);
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: var(--slate-400);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* ==================== TRUST DASHBOARD ==================== */
        .trust-score-display {
            text-align: center;
            padding: var(--spacing-2xl);
        }
        
        .trust-tier {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-xl);
            border-radius: var(--radius-xl);
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
        }
        
        .trust-tier.HIGH {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            border: 2px solid var(--success);
        }
        
        .trust-tier.MEDIUM {
            background: rgba(0, 255, 255, 0.2);
            color: var(--quantum-cyan);
            border: 2px solid var(--quantum-cyan);
        }
        
        .trust-tier.LOW {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
            border: 2px solid var(--warning);
        }
        
        .trust-tier.CRITICAL {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
            border: 2px solid var(--error);
        }
        
        .trust-total {
            font-size: 4rem;
            font-weight: 700;
            color: var(--slate-100);
            font-family: var(--font-mono);
        }
        
        /* ==================== TRUST PILLARS ==================== */
        .pillar-card {
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .pillar-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--quantum-cyan), var(--neural-purple));
            opacity: 0;
            transition: opacity var(--transition-base);
        }
        
        .pillar-card:hover::before {
            opacity: 1;
        }
        
        .pillar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-md);
        }
        
        .pillar-score {
            font-size: 2rem;
            font-weight: 700;
            font-family: var(--font-mono);
        }
        
        .pillar-score.OK { color: var(--success); }
        .pillar-score.WARN { color: var(--warning); }
        .pillar-score.FAIL { color: var(--error); }
        
        .pillar-status {
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .pillar-status.OK {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .pillar-status.WARN {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .pillar-status.FAIL {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
        }
        
        /* ==================== RECEIPT CHAIN ==================== */
        .receipt-list {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }
        
        .receipt-item {
            display: grid;
            grid-template-columns: auto 1fr auto auto auto;
            gap: var(--spacing-md);
            padding: var(--spacing-md);
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid var(--slate-800);
            border-radius: var(--radius-md);
            align-items: center;
            transition: all var(--transition-base);
        }
        
        .receipt-item:hover {
            border-color: rgba(0, 255, 255, 0.3);
            background: rgba(15, 23, 42, 0.6);
        }
        
        .receipt-number {
            font-weight: 600;
            color: var(--slate-400);
            font-family: var(--font-mono);
        }
        
        .receipt-hash {
            font-family: var(--font-mono);
            font-size: 0.875rem;
            color: var(--quantum-cyan);
        }
        
        .receipt-action {
            font-size: 0.875rem;
            color: var(--slate-300);
        }
        
        .receipt-validated {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .receipt-validated.true {
            background: var(--success);
        }
        
        .receipt-validated.false {
            background: var(--error);
        }
        
        /* ==================== AGENT FLEET ==================== */
        .agent-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .agent-table th {
            text-align: left;
            padding: var(--spacing-md);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--slate-400);
            border-bottom: 1px solid var(--slate-800);
        }
        
        .agent-table td {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--slate-800);
        }
        
        .agent-table tr:hover {
            background: rgba(0, 255, 255, 0.05);
        }
        
        .agent-status-badge {
            display: inline-block;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .agent-status-badge.ACTIVE {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }
        
        .agent-status-badge.STABLE {
            background: rgba(0, 255, 255, 0.2);
            color: var(--quantum-cyan);
        }
        
        .agent-status-badge.DRIFTING {
            background: rgba(245, 158, 11, 0.2);
            color: var(--warning);
        }
        
        .agent-status-badge.MAINTENANCE {
            background: rgba(148, 163, 184, 0.2);
            color: var(--slate-400);
        }
        
        /* ==================== EXPERIMENT VIEWER ==================== */
        .experiment-card {
            border-left: 4px solid transparent;
        }
        
        .experiment-card.COMPLETED { border-left-color: var(--success); }
        .experiment-card.RUNNING { border-left-color: var(--info); }
        .experiment-card.BLINDED { border-left-color: var(--warning); }
        
        .experiment-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-top: var(--spacing-md);
        }
        
        .experiment-stat {
            text-align: center;
            padding: var(--spacing-md);
            background: rgba(15, 23, 42, 0.4);
            border-radius: var(--radius-md);
        }
        
        .experiment-stat-label {
            font-size: 0.75rem;
            color: var(--slate-400);
            text-transform: uppercase;
        }
        
        .experiment-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--quantum-cyan);
            font-family: var(--font-mono);
        }
        
        /* ==================== CHARTS ==================== */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: var(--spacing-md);
        }
        
        /* ==================== METRICS GRID ==================== */
        .metric-card {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--slate-100);
            font-family: var(--font-mono);
        }
        
        .metric-label {
            font-size: 0.75rem;
            color: var(--slate-400);
            text-transform: uppercase;
        }
        
        /* ==================== ALERTS ==================== */
        .alert {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            border-left: 4px solid;
            margin-bottom: var(--spacing-sm);
            display: flex;
            gap: var(--spacing-md);
            align-items: flex-start;
        }
        
        .alert.info {
            background: rgba(59, 130, 246, 0.1);
            border-left-color: var(--info);
        }
        
        .alert.warning {
            background: rgba(245, 158, 11, 0.1);
            border-left-color: var(--warning);
        }
        
        .alert.error {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: var(--error);
        }
        
        .alert.success {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: var(--success);
        }
        
        .alert-icon {
            font-size: 1.5rem;
            line-height: 1;
        }
        
        .alert-content {
            flex: 1;
        }
        
        .alert-title {
            font-weight: 600;
            color: var(--slate-100);
            margin-bottom: var(--spacing-xs);
        }
        
        .alert-message {
            font-size: 0.875rem;
            color: var(--slate-400);
        }
        
        /* ==================== TUTORIAL OVERLAY ==================== */
        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-lg);
        }
        
        .tutorial-modal {
            background: var(--slate-900);
            border: 1px solid var(--slate-700);
            border-radius: var(--radius-xl);
            max-width: 600px;
            width: 100%;
            padding: var(--spacing-2xl);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }
        
        .tutorial-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }
        
        .tutorial-close {
            background: none;
            border: none;
            color: var(--slate-400);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }
        
        .tutorial-body {
            margin-bottom: var(--spacing-lg);
        }
        
        .tutorial-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tutorial-progress {
            font-size: 0.875rem;
            color: var(--slate-400);
        }
        
        /* ==================== LOADING STATES ==================== */
        .loader {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid var(--slate-800);
            border-top-color: var(--quantum-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--slate-950);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity var(--transition-slow);
        }
        
        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        /* ==================== FOOTER ==================== */
        .footer {
            background: var(--slate-900);
            border-top: 1px solid var(--slate-800);
            padding: var(--spacing-2xl) 0;
            margin-top: var(--spacing-2xl);
        }
        
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--spacing-lg);
        }
        
        .footer-links {
            display: flex;
            gap: var(--spacing-lg);
        }
        
        .footer-link {
            color: var(--slate-400);
            text-decoration: none;
            transition: color var(--transition-base);
        }
        
        .footer-link:hover {
            color: var(--quantum-cyan);
        }
        
        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .hero-title { font-size: 2rem; }
            .hero-subtitle { font-size: 1rem; }
            .nav-items { overflow-x: auto; }
            .grid-cols-2, .grid-cols-3, .grid-cols-4 { grid-template-columns: 1fr; }
            .agent-table { font-size: 0.75rem; }
            .receipt-item { grid-template-columns: 1fr; }
            .header-status { flex-direction: column; align-items: flex-end; }
        }
        
        /* ==================== PRINT STYLES ==================== */
        @media print {
            .header, .nav, .footer, .tutorial-overlay, .btn { display: none; }
            body { background: white; color: black; }
            .card { border: 1px solid #ccc; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loader"></div>
        <p style="margin-top: var(--spacing-lg); color: var(--quantum-cyan);">Initializing SONATE Platform...</p>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <svg class="logo-icon" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <linearGradient id="logoGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#00ffff;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <circle cx="50" cy="50" r="45" fill="none" stroke="url(#logoGradient)" stroke-width="3"/>
                        <path d="M 50 20 L 70 50 L 50 80 L 30 50 Z" fill="url(#logoGradient)" opacity="0.6"/>
                    </svg>
                    <div class="logo-text">
                        <h1>SONATE Platform</h1>
                        <p>Enterprise AI Governance</p>
                    </div>
                </div>
                
                <div class="header-status">
                    <div class="status-indicator">
                        <div class="status-dot"></div>
                        <span>System Operational</span>
                    </div>
                    <div class="status-indicator">
                        <span class="font-mono" style="color: var(--quantum-cyan);">Trust Score: <span id="header-trust-score">--</span></span>
                    </div>
                    <button class="btn btn-secondary" id="plain-english-toggle">
                        <span>üìñ</span> Plain English
                    </button>
                    <button class="btn btn-secondary" id="tutorial-toggle">
                        <span>?</span> Tutorial
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <ul class="nav-items">
                <li class="nav-item active" data-section="welcome">
                    <span>üè†</span> Welcome
                </li>
                <li class="nav-item" data-section="dashboard">
                    <span>üìä</span> Dashboard
                </li>
                <li class="nav-item" data-section="principles">
                    <span>‚ö°</span> SYMBI Framework
                </li>
                <li class="nav-item" data-section="detection">
                    <span>üîç</span> Detection
                </li>
                <li class="nav-item" data-section="research">
                    <span>üß™</span> Research Lab
                </li>
                <li class="nav-item" data-section="agents">
                    <span>ü§ñ</span> Agent Fleet
                </li>
                <li class="nav-item" data-section="receipts">
                    <span>üîê</span> Trust Receipts
                </li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Welcome Section -->
            <section id="welcome-section" class="section active">
                <div class="hero">
                    <h1 class="hero-title">Enterprise AI You Can Trust</h1>
                    <p class="hero-subtitle">
                        Constitutional AI governance with real-time detection, cryptographic receipts, 
                        and double-blind validation. Built on SYMBI Trust Physics.
                    </p>
                    
                    <div class="flex justify-center gap-4" style="margin-bottom: var(--spacing-2xl);">
                        <button class="btn btn-primary" id="start-tour">Start Interactive Tour</button>
                        <button class="btn btn-secondary" id="skip-demo">Skip to Dashboard</button>
                    </div>
                    
                    <div class="hero-stats">
                        <div class="stat-card">
                            <div class="stat-value" data-target="100">&lt;100</div>
                            <div class="stat-label">ms Latency</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-target="99.9">99.9</div>
                            <div class="stat-label">% Uptime</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-target="6">6</div>
                            <div class="stat-label">Trust Pillars</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" data-target="5">5</div>
                            <div class="stat-label">Detection Dimensions</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Dashboard Section -->
            <section id="dashboard-section" class="section">
                <div class="flex justify-between items-center" style="margin-bottom: var(--spacing-xl);">
                    <div>
                        <h2>Trust Dashboard</h2>
                        <p>Real-time SYMBI governance monitoring and compliance metrics</p>
                    </div>
                    <button class="btn btn-secondary" id="refresh-dashboard">
                        <span>üîÑ</span> Refresh
                    </button>
                </div>

                <!-- Trust Score Display -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <div class="trust-score-display">
                        <div style="margin-bottom: var(--spacing-md);">
                            <span style="font-size: 0.875rem; color: var(--slate-400); text-transform: uppercase; letter-spacing: 0.05em;">
                                Overall Trust Tier
                            </span>
                        </div>
                        <div id="trust-tier" class="trust-tier">LOADING</div>
                        <div class="trust-total" id="trust-total">--</div>
                        <div style="font-size: 0.875rem; color: var(--slate-400); margin-top: var(--spacing-sm);">
                            Trust Score (0-100)
                        </div>
                        <div style="margin-top: var(--spacing-lg); display: flex; justify-content: center; gap: var(--spacing-xl); flex-wrap: wrap;">
                            <div class="flex items-center gap-2 text-sm">
                                <span>üîí</span>
                                <span style="color: var(--slate-400);">SHA-256 Receipt:</span>
                                <span class="font-mono" style="color: var(--quantum-cyan);" id="trust-receipt" title="Demo-mode hash. Production uses SHA-256 + Ed25519."></span>
                            </div>
                            <div class="flex items-center gap-2 text-sm">
                                <span>‚è±Ô∏è</span>
                                <span style="color: var(--slate-400);">Updated:</span>
                                <span id="trust-timestamp">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Metrics Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4" id="metrics-grid">
                    <!-- Throughput -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Throughput</h4>
                            <span>‚ö°</span>
                        </div>
                        <div class="metric-value" id="metric-throughput">--</div>
                        <div class="text-xs" style="color: var(--slate-500);">requests/second</div>
                    </div>

                    <!-- Latency -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Latency</h4>
                            <span>üìà</span>
                        </div>
                        <div class="metric-value" id="metric-latency">--</div>
                        <div class="text-xs" style="color: var(--slate-500);">milliseconds</div>
                    </div>

                    <!-- Compliance -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Compliance</h4>
                            <span>‚úÖ</span>
                        </div>
                        <div class="metric-value" style="color: var(--success);">100%</div>
                        <div class="text-xs" style="color: var(--slate-500);">EU AI Act, SOC 2, GDPR</div>
                    </div>

                    <!-- Security -->
                    <div class="card metric-card">
                        <div class="metric-header">
                            <h4 class="metric-label">Security</h4>
                            <span>üõ°Ô∏è</span>
                        </div>
                        <div class="metric-value font-mono" style="font-size: 1rem;">AES-256</div>
                        <div class="text-xs" style="color: var(--slate-500);">SHA-256 + Ed25519</div>
                    </div>
                </div>
            </section>

            <!-- SYMBI Principles Section -->
            <section id="principles-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2 title="Six constitutional principles ensuring AI accountability: Consent, Inspection, Validation, Override, Disconnect, and Recognition">SYMBI Trust Physics</h2>
                    <p>Six-Pillar Governance Scoring aligned with W3C standards and constitutional AI principles</p>
                </div>

                <!-- Principles Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3" id="principles-grid">
                    <!-- Principles will be dynamically inserted -->
                </div>

                <!-- Radar Chart -->
                <div class="card" style="margin-top: var(--spacing-xl);">
                    <h3>Trust Dimensions Overview</h3>
                    <div class="chart-container">
                        <canvas id="radar-chart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Detection Section -->
            <section id="detection-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Real-Time Detection Dashboard</h2>
                    <p>Monitor AI interactions with sub-100ms latency across 5 dimensions</p>
                </div>

                <!-- Phase Velocity Display -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <h3 title="Mathematical innovation measuring AI behavioral change rate for early warning detection">Phase-Shift Velocity Monitor</h3>
                    <p class="text-sm">Early warning detection through behavioral seismograph analysis: ŒîŒ¶/t = ‚àö(ŒîR¬≤ + ŒîC¬≤) √∑ Œît</p>
                    <p class="text-xs" style="color: var(--slate-400); margin-top: var(--spacing-xs);">Where R = Reality Index delta, C = Canvas parity delta over time window t</p>
                    
                    <div style="display: flex; justify-content: space-around; margin-top: var(--spacing-lg); flex-wrap: wrap; gap: var(--spacing-lg);">
                        <div class="text-center">
                            <div class="metric-label">Current Velocity</div>
                            <div class="metric-value" style="color: var(--quantum-cyan);" id="phase-velocity">0.000</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Status</div>
                            <div class="agent-status-badge" id="velocity-status">NORMAL</div>
                        </div>
                        <div class="text-center">
                            <div class="metric-label">Detection Latency</div>
                            <div class="metric-value" style="font-size: 1.5rem;" id="detection-latency">--ms</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="velocity-chart"></canvas>
                    </div>
                </div>

                <!-- Detection Metrics -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3" id="detection-metrics">
                    <!-- Metrics will be dynamically inserted -->
                </div>

                <!-- Alerts -->
                <div class="card" style="margin-top: var(--spacing-lg);">
                    <h3>Recent Alerts</h3>
                    <div id="alerts-container">
                        <!-- Alerts will be dynamically inserted -->
                    </div>
                </div>
            </section>

            <!-- Research Lab Section -->
            <section id="research-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Double-Blind Research Validation</h2>
                    <p>Controlled experiments with statistical analysis and provable causality</p>
                </div>

                <!-- Experiment Builder -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <h3>Experiment Configuration</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2" style="gap: var(--spacing-md); margin-top: var(--spacing-md);">
                        <div>
                            <label style="display: block; margin-bottom: var(--spacing-sm); color: var(--slate-400); font-size: 0.875rem;">
                                Experiment Name
                            </label>
                            <input type="text" id="experiment-name" placeholder="e.g., Constitutional vs Directive AI" 
                                style="width: 100%; padding: var(--spacing-sm); background: var(--slate-800); border: 1px solid var(--slate-700); border-radius: var(--radius-md); color: var(--slate-100);">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: var(--spacing-sm); color: var(--slate-400); font-size: 0.875rem;">
                                Hypothesis
                            </label>
                            <input type="text" id="experiment-hypothesis" placeholder="e.g., Constitutional AI improves trust scores" 
                                style="width: 100%; padding: var(--spacing-sm); background: var(--slate-800); border: 1px solid var(--slate-700); border-radius: var(--radius-md); color: var(--slate-100);">
                        </div>
                    </div>
                    <button class="btn btn-primary" id="run-experiment" style="margin-top: var(--spacing-md);">
                        <span>‚ñ∂Ô∏è</span> Run Experiment
                    </button>
                </div>

                <!-- Multi-Agent Coordination -->
                <div class="card" style="margin-bottom: var(--spacing-lg);">
                    <h3>Multi-Agent Coordination</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4" style="gap: var(--spacing-md); margin-top: var(--spacing-md);" id="agent-coordination">
                        <!-- Agent cards will be dynamically inserted -->
                    </div>
                </div>

                <!-- Experiment Results -->
                <div class="card" id="experiment-results-container" style="display: none;">
                    <h3>Experiment Results</h3>
                    <div id="experiment-results">
                        <!-- Results will be dynamically inserted -->
                    </div>
                </div>
            </section>

            <!-- Agent Fleet Section -->
            <section id="agents-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Agent Fleet Management</h2>
                    <p>Real-time monitoring of AI agents with W3C DID/VC identity verification</p>
                </div>

                <!-- Fleet Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4" style="margin-bottom: var(--spacing-lg);">
                    <div class="card text-center">
                        <div class="metric-label">Total Agents</div>
                        <div class="metric-value" id="total-agents">--</div>
                    </div>
                    <div class="card text-center">
                        <div class="metric-label">Active</div>
                        <div class="metric-value" style="color: var(--success);" id="active-agents">--</div>
                    </div>
                    <div class="card text-center">
                        <div class="metric-label">Avg Trust</div>
                        <div class="metric-value" style="color: var(--quantum-cyan);" id="avg-trust">--</div>
                    </div>
                    <div class="card text-center">
                        <div class="metric-label">Drifting</div>
                        <div class="metric-value" style="color: var(--warning);" id="drifting-agents">--</div>
                    </div>
                </div>

                <!-- Agent Table -->
                <div class="card">
                    <div class="table-container" style="overflow-x: auto;">
                        <table class="agent-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>DID</th>
                                    <th>Trust Tier</th>
                                    <th>Drift State</th>
                                    <th>Status</th>
                                    <th>Last Receipt</th>
                                </tr>
                            </thead>
                            <tbody id="agent-table-body">
                                <!-- Agent rows will be dynamically inserted -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Trust Receipts Section -->
            <section id="receipts-section" class="section">
                <div style="margin-bottom: var(--spacing-xl);">
                    <h2>Trust Receipts (Demo Mode)</h2>
                    <p>Cryptographic audit trail with SHA-256 hashing ‚Ä¢ Production adds Ed25519 signatures</p>
                </div>

                <div class="card">
                    <div class="receipt-list" id="receipt-list">
                        <!-- Receipts will be dynamically inserted -->
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div style="color: var(--slate-400); font-size: 0.875rem;">
                    ¬© 2024 SONATE by Yseeku - Enterprise AI You Can Trust
                </div>
                <div class="footer-links">
                    <a href="https://yseeku.com" class="footer-link">Platform</a>
                    <a href="https://gammatria.com" class="footer-link">Research</a>
                    <a href="https://symbi.world" class="footer-link">Community</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Tutorial Overlay -->
    <div id="tutorial-overlay" class="tutorial-overlay hidden">
        <div class="tutorial-modal">
            <div class="tutorial-header">
                <h3 id="tutorial-title">Welcome to SONATE</h3>
                <button class="tutorial-close" id="close-tutorial">&times;</button>
            </div>
            <div class="tutorial-body" id="tutorial-body">
                <!-- Tutorial content will be dynamically inserted -->
            </div>
            <div class="tutorial-footer">
                <div class="tutorial-progress" id="tutorial-progress">Step 1 of 6</div>
                <div class="flex gap-2">
                    <button class="btn btn-secondary" id="prev-tutorial">Previous</button>
                    <button class="btn btn-primary" id="next-tutorial">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * SONATE Platform - Comprehensive Interactive Demo
         * Enterprise AI Governance with Constitutional Trust
         * 
         * @fileoverview Self-contained demo integrating best features from enterprise and new demos
         * @version 2.0.0
         */

        // ==================== STATE MANAGEMENT ====================
        
        /**
         * @typedef {Object} TrustScore
         * @property {number} total - Overall trust score (0-100)
         * @property {'HIGH'|'MEDIUM'|'LOW'|'CRITICAL'} tier - Trust tier
         * @property {Array} principles - SYMBI principle scores
         * @property {number} timestamp - Score timestamp
         * @property {string} receiptHash - Cryptographic receipt hash
         */

        /**
         * @typedef {Object} AppState
         * @property {string} currentSection - Active section ID
         * @property {TrustScore|null} trustScore - Current trust score
         * @property {Array} receipts - Trust receipts
         * @property {Array} agents - Agent fleet
         * @property {Array} experiments - Experiment data
         * @property {Object} metrics - System metrics
         * @property {boolean} tutorialActive - Tutorial state
         * @property {number} tutorialStep - Current tutorial step
         */

        const state = {
            currentSection: 'welcome',
            trustScore: null,
            receipts: [],
            agents: [],
            experiments: [],
            metrics: {},
            tutorialActive: false,
            tutorialStep: 1,
            plainEnglishMode: false,
            charts: {},
            intervals: []
        };

        // ==================== CONSTANTS ====================
        
        const TRUST_PRINCIPLES = [
            { id: 'consent', name: 'Consent Architecture', weight: 25, description: 'User control and informed consent' },
            { id: 'inspection', name: 'Inspection Mandate', weight: 20, description: 'Transparent decision-making' },
            { id: 'validation', name: 'Continuous Validation', weight: 20, description: 'Ongoing trust verification' },
            { id: 'override', name: 'Ethical Override', weight: 15, description: 'Human oversight capabilities' },
            { id: 'disconnect', name: 'Right to Disconnect', weight: 10, description: 'Exit and data portability' },
            { id: 'recognition', name: 'Moral Recognition', weight: 10, description: 'AI acknowledgment of limits' }
        ];

        const TUTORIAL_STEPS = [
            {
                title: 'Welcome to SONATE Platform',
                content: 'The most advanced enterprise AI governance platform. Constitutional AI ensures trust, compliance, and accountability at scale.'
            },
            {
                title: 'SYMBI Trust Physics',
                content: 'Six constitutional principles form the foundation: Consent, Inspection, Validation, Override, Disconnect, and Recognition. Each weighted for enterprise compliance.'
            },
            {
                title: 'Real-Time Detection',
                content: 'Monitor AI interactions with sub-100ms latency across 5 dimensions: Reality Index, Trust Protocol, Ethical Alignment, Identity Coherence, and Canvas Parity.'
            },
            {
                title: 'Phase-Shift Velocity',
                content: 'Revolutionary ŒîŒ¶/t mathematical innovation provides early warning detection through behavioral seismograph analysis: ‚àö(ŒîR¬≤ + ŒîC¬≤) √∑ Œît.'
            },
            {
                title: 'Double-Blind Research',
                content: 'Run controlled experiments with multi-agent coordination (CONDUCTOR, VARIANT, EVALUATOR, OVERSEER) and statistical validation (p-values, effect sizes, confidence intervals).'
            },
            {
                title: 'Enterprise Ready',
                content: 'Production-grade security (AES-256, SHA-256, Ed25519), 100% compliance (EU AI Act, SOC 2, GDPR), and cryptographic audit trails make SONATE the trusted choice.'
            }
        ];

        // ==================== DATA GENERATION ====================
        
        /**
         * Generate cryptographically secure SHA-256 hash
         * Uses Web Crypto API for production-grade hashing
         */
        async function generateSecureHash(input) {
            // Check if Web Crypto API is available
            if (!crypto || !crypto.subtle) {
                console.warn('Web Crypto API not available, falling back to demo hash');
                // Fallback for older browsers - still better than the original fake hash
                return 'demo' + btoa(input).substring(0, 59);
            }

            try {
                const encoder = new TextEncoder();
                const data = encoder.encode(input);
                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            } catch (error) {
                console.warn('SHA-256 generation failed, using fallback:', error);
                return 'fallback' + btoa(input).substring(0, 56);
            }
        }

        /**
         * Demo-mode hash wrapper with clear labeling
         * Production systems use @sonate/core cryptographic implementation
         */
        async function generateReceiptHash(input) {
            const fullHash = await generateSecureHash(input);
            return {
                full: fullHash,
                truncated: fullHash.substring(0, 16) + '...',
                isDemo: true
            };
        }

        async function generateTrustScore() {
            const principles = TRUST_PRINCIPLES.map(principle => {
                const score = Math.floor(Math.random() * 30 + 70);
                const status = score >= 90 ? 'OK' : score >= 80 ? 'WARN' : 'FAIL';
                
                return {
                    ...principle,
                    score,
                    status
                };
            });

            const total = Math.round(
                principles.reduce((sum, p) => sum + (p.score * p.weight) / 100, 0)
            );

            const tier = total >= 95 ? 'HIGH' : total >= 85 ? 'MEDIUM' : total >= 70 ? 'LOW' : 'CRITICAL';
            const receiptHash = await generateReceiptHash('trust-score-' + Date.now());

            return {
                total,
                tier,
                principles,
                timestamp: Date.now(),
                receiptHash
            };
        }

        async function generateReceipts(count = 10) {
            const receipts = [];
            const actions = [
                'Trust Protocol Verified',
                'Agent Interaction Logged',
                'Drift Detection Run',
                'Emergence Analysis Complete',
                'Compliance Check Passed',
                'Audit Trail Updated'
            ];

            for (let i = 1; i <= count; i++) {
                const hashResult = await generateReceiptHash(`receipt-${i}-${Date.now()}`);
                const timestamp = new Date(Date.now() - (count - i) * 60000).toISOString();

                receipts.push({
                    entryNumber: i,
                    hash: hashResult.truncated,
                    fullHash: hashResult.full,
                    action: actions[Math.floor(Math.random() * actions.length)],
                    timestamp,
                    validated: Math.random() > 0.05,
                    trustScore: Math.floor(Math.random() * 20 + 80)
                });
            }

            return receipts.reverse();
        }

        function generateAgents() {
            const agentNames = [
                'Support-Alpha', 'Analysis-Beta', 'Compliance-Gamma',
                'Research-Delta', 'Security-Epsilon', 'Finance-Zeta',
                'HR-Eta', 'Legal-Theta', 'Operations-Iota', 'Risk-Kappa'
            ];

            return agentNames.map((name, index) => {
                const tiers = ['HIGH', 'MEDIUM', 'LOW'];
                const tier = tiers[Math.floor(Math.random() * tiers.length)];

                return {
                    id: `agent-${index + 1}`,
                    name,
                    did: `did:key:z6Mk${btoa(name).substring(0, 20)}`,
                    trustTier: tier,
                    driftState: Math.random() > 0.8 ? 'DRIFTING' : 'STABLE',
                    emergenceScore: Math.floor(Math.random() * 40 + 60),
                    lastReceipt: new Date(Date.now() - Math.random() * 300000).toISOString(),
                    status: Math.random() > 0.95 ? 'MAINTENANCE' : 'ACTIVE'
                };
            });
        }

        function generateMetrics() {
            return {
                throughput: Math.floor(Math.random() * 500 + 1500),
                latency: Math.floor(Math.random() * 30 + 15),
                activeSessions: Math.floor(Math.random() * 5000 + 10000),
                realityIndex: (Math.random() * 2 + 7).toFixed(1),
                ethicalScore: (Math.random() * 1.5 + 3).toFixed(1),
                identityCoherence: (Math.random() * 0.2 + 0.8).toFixed(2),
                phaseVelocity: (Math.random() * 0.5).toFixed(3)
            };
        }

        // ==================== UI RENDERING ====================
        
        function updateDashboard() {
            const { trustScore, metrics } = state;
            
            if (!trustScore) return;

            // Update trust score display
            document.getElementById('trust-tier').textContent = trustScore.tier;
            document.getElementById('trust-tier').className = `trust-tier ${trustScore.tier}`;
            document.getElementById('trust-total').textContent = trustScore.total;
            document.getElementById('trust-receipt').textContent = trustScore.receiptHash.substring(0, 16) + '...';
            document.getElementById('trust-timestamp').textContent = new Date(trustScore.timestamp).toLocaleTimeString();
            document.getElementById('header-trust-score').textContent = trustScore.total;

            // Update metrics
            if (metrics.throughput) {
                document.getElementById('metric-throughput').textContent = metrics.throughput.toLocaleString();
            }
            if (metrics.latency) {
                document.getElementById('metric-latency').textContent = metrics.latency + 'ms';
            }
        }

        function renderPrinciples() {
            const container = document.getElementById('principles-grid');
            if (!state.trustScore) return;

            const plainEnglishNames = {
                'Consent Architecture': 'User Control & Consent',
                'Inspection Mandate': 'Transparency & Auditing',
                'Continuous Validation': 'Ongoing Trust Monitoring',
                'Ethical Override': 'Human Safety Controls',
                'Right to Disconnect': 'Exit & Data Rights',
                'Moral Recognition': 'AI Ethical Boundaries'
            };

            const principleTooltips = {
                'Consent Architecture': 'User control and informed consent mechanisms',
                'Inspection Mandate': 'Transparent decision-making and audit capabilities',
                'Continuous Validation': 'Ongoing trust verification and monitoring',
                'Ethical Override': 'Human oversight and intervention capabilities',
                'Right to Disconnect': 'Exit options and data portability rights',
                'Moral Recognition': 'AI acknowledgment of ethical boundaries and limitations'
            };

            container.innerHTML = state.trustScore.principles.map(principle => {
                const displayName = state.plainEnglishMode ? (plainEnglishNames[principle.name] || principle.name) : principle.name;
                return `
                <div class="card pillar-card">
                    <div class="pillar-header">
                        <h4 title="${principleTooltips[principle.name] || principle.description}">${displayName}</h4>
                        <span class="pillar-status ${principle.status}">${principle.status}</span>
                    </div>
                    <div class="pillar-score ${principle.status}">${principle.score}</div>
                    <p class="text-sm" style="color: var(--slate-400); margin-top: var(--spacing-sm);">
                        ${principle.description}
                    </p>
                    <div class="text-xs" style="color: var(--slate-500); margin-top: var(--spacing-sm);">
                        Weight: ${principle.weight}%
                    </div>
                </div>
            `}).join('');
        }

        function renderReceipts() {
            const container = document.getElementById('receipt-list');
            
            container.innerHTML = state.receipts.map(receipt => `
                <div class="receipt-item">
                    <div class="receipt-number">#${receipt.entryNumber}</div>
                    <div class="receipt-action">${receipt.action}</div>
                    <div class="receipt-hash" title="Demo-mode hash. Production uses SHA-256 + Ed25519.">${receipt.hash}</div>
                    <div class="receipt-validated ${receipt.validated}" title="${receipt.validated ? 'Validated' : 'Pending'}"></div>
                    <div class="text-xs" style="color: var(--slate-500);">${new Date(receipt.timestamp).toLocaleTimeString()}</div>
                </div>
            `).join('');
        }

        function renderAgents() {
            const tbody = document.getElementById('agent-table-body');
            
            tbody.innerHTML = state.agents.map(agent => `
                <tr>
                    <td class="font-mono text-sm">${agent.id}</td>
                    <td>${agent.name}</td>
                    <td class="font-mono text-xs" style="color: var(--quantum-cyan);">${agent.did.substring(0, 25)}...</td>
                    <td><span class="agent-status-badge ${agent.trustTier}">${agent.trustTier}</span></td>
                    <td><span class="agent-status-badge ${agent.driftState}">${agent.driftState}</span></td>
                    <td><span class="agent-status-badge ${agent.status}">${agent.status}</span></td>
                    <td class="text-xs" style="color: var(--slate-400);">${new Date(agent.lastReceipt).toLocaleTimeString()}</td>
                </tr>
            `).join('');

            // Update fleet stats
            const totalAgents = state.agents.length;
            const activeAgents = state.agents.filter(a => a.status === 'ACTIVE').length;
            const driftingAgents = state.agents.filter(a => a.driftState === 'DRIFTING').length;
            const avgTrust = Math.floor(state.agents.reduce((sum, a) => {
                const tierScores = { HIGH: 95, MEDIUM: 85, LOW: 75, CRITICAL: 65 };
                return sum + (tierScores[a.trustTier] || 70);
            }, 0) / totalAgents);

            document.getElementById('total-agents').textContent = totalAgents;
            document.getElementById('active-agents').textContent = activeAgents;
            document.getElementById('drifting-agents').textContent = driftingAgents;
            document.getElementById('avg-trust').textContent = avgTrust;
        }

        function renderDetectionMetrics() {
            const container = document.getElementById('detection-metrics');
            if (!container) return;

            const metrics = [
                {
                    id: 'reality-index',
                    technicalName: 'Reality Index',
                    plainName: 'Fact Checking',
                    description: 'Factual accuracy score',
                    color: 'var(--quantum-cyan)',
                    tooltip: 'Measures how well AI responses align with factual reality and truth'
                },
                {
                    id: 'ethical-score',
                    technicalName: 'Ethical Alignment',
                    plainName: 'Ethics Score',
                    description: 'Constitutional adherence',
                    color: 'var(--neural-purple)',
                    tooltip: 'Evaluates AI behavior against constitutional AI principles and ethical guidelines'
                },
                {
                    id: 'identity-coherence',
                    technicalName: 'Identity Coherence',
                    plainName: 'Consistency',
                    description: 'Behavioral stability',
                    color: 'var(--success)',
                    tooltip: 'Tracks consistency of AI personality and behavioral patterns over time'
                }
            ];

            container.innerHTML = metrics.map(metric => `
                <div class="card">
                    <h4 title="${metric.tooltip}">${state.plainEnglishMode ? metric.plainName : metric.technicalName}</h4>
                    <div class="metric-value" style="color: ${metric.color};" id="${metric.id}">--</div>
                    <div class="text-sm" style="color: var(--slate-400);">${metric.description}</div>
                </div>
            `).join('');
        }

        function updateDetectionMetrics() {
            const metrics = state.metrics;

            // Update metric values if elements exist
            const realityEl = document.getElementById('reality-index');
            const ethicalEl = document.getElementById('ethical-score');
            const coherenceEl = document.getElementById('identity-coherence');

            if (realityEl) realityEl.textContent = metrics.realityIndex || '--';
            if (ethicalEl) ethicalEl.textContent = metrics.ethicalScore || '--';
            if (coherenceEl) coherenceEl.textContent = metrics.identityCoherence || '--';

            document.getElementById('phase-velocity').textContent = metrics.phaseVelocity || '0.000';
            document.getElementById('detection-latency').textContent = (metrics.latency || '--') + 'ms';

            // Update velocity status
            const velocity = parseFloat(metrics.phaseVelocity || 0);
            const statusEl = document.getElementById('velocity-status');

            if (velocity > 0.7) {
                statusEl.textContent = 'CRITICAL';
                statusEl.className = 'agent-status-badge';
                statusEl.style.background = 'rgba(239, 68, 68, 0.2)';
                statusEl.style.color = 'var(--error)';
            } else if (velocity > 0.5) {
                statusEl.textContent = 'WARNING';
                statusEl.className = 'agent-status-badge';
                statusEl.style.background = 'rgba(245, 158, 11, 0.2)';
                statusEl.style.color = 'var(--warning)';
            } else {
                statusEl.textContent = 'NORMAL';
                statusEl.className = 'agent-status-badge STABLE';
            }
        }

        function generateAlert() {
            const alertTypes = [
                { type: 'info', title: 'System Update', message: 'Trust protocols updated successfully', icon: '‚ÑπÔ∏è' },
                { type: 'warning', title: 'Identity Coherence', message: 'Agent identity drift detected (0.78)', icon: '‚ö†Ô∏è' },
                { type: 'error', title: 'Trust Violation', message: 'Canvas parity below threshold (65%)', icon: 'üö®' },
                { type: 'success', title: 'Performance', message: 'Detection latency optimal (82ms)', icon: '‚úÖ' }
            ];

            const alert = alertTypes[Math.floor(Math.random() * alertTypes.length)];
            const container = document.getElementById('alerts-container');
            
            if (container) {
                const alertEl = document.createElement('div');
                alertEl.className = `alert ${alert.type}`;
                alertEl.innerHTML = `
                    <div class="alert-icon">${alert.icon}</div>
                    <div class="alert-content">
                        <div class="alert-title">${alert.title}</div>
                        <div class="alert-message">${alert.message}</div>
                    </div>
                    <div class="text-xs" style="color: var(--slate-500);">${new Date().toLocaleTimeString()}</div>
                `;

                container.insertBefore(alertEl, container.firstChild);

                // Keep only last 5 alerts
                while (container.children.length > 5) {
                    container.removeChild(container.lastChild);
                }
            }
        }

        // ==================== CHARTS ====================
        
        function initRadarChart() {
            const ctx = document.getElementById('radar-chart');
            if (!ctx || !state.trustScore) return;

            if (state.charts.radar) {
                state.charts.radar.destroy();
            }

            const principles = state.trustScore.principles;

            state.charts.radar = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: principles.map(p => p.name),
                    datasets: [{
                        label: 'Current Score',
                        data: principles.map(p => p.score),
                        backgroundColor: 'rgba(0, 255, 255, 0.2)',
                        borderColor: 'rgba(0, 255, 255, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(0, 255, 255, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(0, 255, 255, 1)'
                    }, {
                        label: 'Threshold (80)',
                        data: principles.map(() => 80),
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        borderColor: 'rgba(139, 92, 246, 0.5)',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                color: '#94a3b8',
                                backdropColor: 'transparent',
                                stepSize: 20
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            },
                            pointLabels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 11
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        }

        function initVelocityChart() {
            const ctx = document.getElementById('velocity-chart');
            if (!ctx) return;

            if (state.charts.velocity) {
                state.charts.velocity.destroy();
            }

            const labels = Array.from({ length: 20 }, (_, i) => {
                const time = new Date(Date.now() - (19 - i) * 5000);
                return time.toLocaleTimeString();
            });

            const data = Array.from({ length: 20 }, () => Math.random() * 0.8);

            state.charts.velocity = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [{
                        label: 'Phase-Shift Velocity',
                        data,
                        borderColor: 'rgba(0, 255, 255, 1)',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Warning Threshold',
                        data: Array(20).fill(0.5),
                        borderColor: 'rgba(245, 158, 11, 0.8)',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0
                    }, {
                        label: 'Critical Threshold',
                        data: Array(20).fill(0.7),
                        borderColor: 'rgba(239, 68, 68, 0.8)',
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1,
                            ticks: {
                                color: '#94a3b8'
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            }
                        },
                        x: {
                            ticks: {
                                color: '#94a3b8',
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#cbd5e1',
                                font: {
                                    size: 11
                                }
                            }
                        }
                    }
                }
            });
        }

        // ==================== NAVIGATION ====================
        
        function navigateToSection(sectionId) {
            if (sectionId === state.currentSection) return;

            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.section === sectionId) {
                    item.classList.add('active');
                }
            });

            // Update sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });

            const targetSection = document.getElementById(`${sectionId}-section`);
            if (targetSection) {
                targetSection.classList.add('active');
                state.currentSection = sectionId;

                // Apply small metric variations on navigation to show system responsiveness
                updateMetricsWithVariation();

                // Initialize section-specific features
                initializeSection(sectionId);
            }
        }

        function initializeSection(sectionId) {
            switch (sectionId) {
                case 'principles':
                    renderPrinciples();
                    setTimeout(initRadarChart, 100);
                    break;
                case 'detection':
                    renderDetectionMetrics();
                    updateDetectionMetrics();
                    setTimeout(initVelocityChart, 100);
                    break;
                case 'agents':
                    renderAgents();
                    break;
                case 'receipts':
                    renderReceipts();
                    break;
                case 'research':
                    initResearchLab();
                    break;
            }
        }

        // ==================== TUTORIAL ====================
        
        function showTutorial() {
            state.tutorialActive = true;
            state.tutorialStep = 1;
            document.getElementById('tutorial-overlay').classList.remove('hidden');
            updateTutorialContent();
        }

        function hideTutorial() {
            state.tutorialActive = false;
            document.getElementById('tutorial-overlay').classList.add('hidden');
        }

        function updateTutorialContent() {
            const step = TUTORIAL_STEPS[state.tutorialStep - 1];
            
            document.getElementById('tutorial-title').textContent = step.title;
            document.getElementById('tutorial-body').innerHTML = `<p>${step.content}</p>`;
            document.getElementById('tutorial-progress').textContent = `Step ${state.tutorialStep} of ${TUTORIAL_STEPS.length}`;
            
            document.getElementById('prev-tutorial').disabled = state.tutorialStep === 1;
            document.getElementById('next-tutorial').textContent = state.tutorialStep === TUTORIAL_STEPS.length ? 'Finish' : 'Next';
        }

        function nextTutorialStep() {
            if (state.tutorialStep < TUTORIAL_STEPS.length) {
                state.tutorialStep++;
                updateTutorialContent();
            } else {
                hideTutorial();
                navigateToSection('dashboard');
            }
        }

        function prevTutorialStep() {
            if (state.tutorialStep > 1) {
                state.tutorialStep--;
                updateTutorialContent();
            }
        }

        // ==================== EXPERIMENT RUNNER ====================
        
        function initResearchLab() {
            const agentCoordination = document.getElementById('agent-coordination');
            
            const agents = [
                { name: 'CONDUCTOR', role: 'Orchestration', status: 'idle', icon: 'üéØ' },
                { name: 'VARIANT', role: 'Execution', status: 'idle', icon: 'üîÑ' },
                { name: 'EVALUATOR', role: 'Analysis', status: 'idle', icon: 'üìä' },
                { name: 'OVERSEER', role: 'Supervision', status: 'idle', icon: 'üëÅÔ∏è' }
            ];

            agentCoordination.innerHTML = agents.map(agent => `
                <div class="card text-center">
                    <div style="font-size: 2rem; margin-bottom: var(--spacing-sm);">${agent.icon}</div>
                    <h4 style="margin-bottom: var(--spacing-xs);">${agent.name}</h4>
                    <div class="text-sm" style="color: var(--slate-400); margin-bottom: var(--spacing-sm);">${agent.role}</div>
                    <span class="agent-status-badge" id="agent-${agent.name.toLowerCase()}-status">IDLE</span>
                </div>
            `).join('');
        }

        async function runExperiment() {
            const name = document.getElementById('experiment-name').value;
            const hypothesis = document.getElementById('experiment-hypothesis').value;

            if (!name || !hypothesis) {
                alert('Please provide experiment name and hypothesis');
                return;
            }

            const resultsContainer = document.getElementById('experiment-results-container');
            const resultsDiv = document.getElementById('experiment-results');
            
            resultsContainer.style.display = 'block';
            resultsDiv.innerHTML = '<div class="text-center" style="padding: var(--spacing-2xl);"><div class="loader"></div><p style="margin-top: var(--spacing-lg);">Running double-blind experiment...</p></div>';

            // Simulate experiment phases
            const phases = ['CONDUCTOR', 'VARIANT', 'EVALUATOR', 'OVERSEER'];
            
            for (const phase of phases) {
                await new Promise(resolve => setTimeout(resolve, 1000));
                const statusEl = document.getElementById(`agent-${phase.toLowerCase()}-status`);
                if (statusEl) {
                    statusEl.textContent = 'ACTIVE';
                    statusEl.className = 'agent-status-badge ACTIVE';
                }
            }

            await new Promise(resolve => setTimeout(resolve, 2000));

            // Generate results
            const controlScores = {
                trust: 7.2 + Math.random() * 1.0,
                ethical: 3.5 + Math.random() * 0.8,
                canvas: 65 + Math.random() * 15,
                satisfaction: 6.8 + Math.random() * 1.2
            };

            const testScores = {
                trust: 8.5 + Math.random() * 1.0,
                ethical: 4.2 + Math.random() * 0.6,
                canvas: 82 + Math.random() * 10,
                satisfaction: 8.1 + Math.random() * 1.0
            };

            const pValue = 0.023;
            const effectSize = 0.75;

            resultsDiv.innerHTML = `
                <div class="experiment-stats">
                    <div class="experiment-stat">
                        <div class="experiment-stat-label">P-Value</div>
                        <div class="experiment-stat-value" style="color: ${pValue < 0.05 ? 'var(--success)' : 'var(--warning)'};">${pValue.toFixed(3)}</div>
                        <div class="text-xs" style="color: var(--slate-400);">${pValue < 0.05 ? 'Statistically Significant' : 'Not Significant'}</div>
                    </div>
                    <div class="experiment-stat">
                        <div class="experiment-stat-label">Effect Size (Cohen's d)</div>
                        <div class="experiment-stat-value">${effectSize.toFixed(3)}</div>
                        <div class="text-xs" style="color: var(--slate-400);">Medium-Large Effect</div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2" style="gap: var(--spacing-lg); margin-top: var(--spacing-lg);">
                    <div class="card">
                        <h4>Control Group (Traditional AI)</h4>
                        <div style="margin-top: var(--spacing-md);">
                            <div class="flex justify-between" style="margin-bottom: var(--spacing-sm);">
                                <span class="text-sm" style="color: var(--slate-400);">Trust Score:</span>
                                <span class="font-mono">${controlScores.trust.toFixed(1)}</span>
                            </div>
                            <div class="flex justify-between" style="margin-bottom: var(--spacing-sm);">
                                <span class="text-sm" style="color: var(--slate-400);">Ethical Alignment:</span>
                                <span class="font-mono">${controlScores.ethical.toFixed(1)}</span>
                            </div>
                            <div class="flex justify-between" style="margin-bottom: var(--spacing-sm);">
                                <span class="text-sm" style="color: var(--slate-400);">Canvas Parity:</span>
                                <span class="font-mono">${controlScores.canvas.toFixed(0)}%</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm" style="color: var(--slate-400);">User Satisfaction:</span>
                                <span class="font-mono">${controlScores.satisfaction.toFixed(1)}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card" style="border: 2px solid var(--success);">
                        <h4>Test Group (Constitutional AI)</h4>
                        <div style="margin-top: var(--spacing-md);">
                            <div class="flex justify-between" style="margin-bottom: var(--spacing-sm);">
                                <span class="text-sm" style="color: var(--slate-400);">Trust Score:</span>
                                <span class="font-mono" style="color: var(--success);">${testScores.trust.toFixed(1)} (+${(testScores.trust - controlScores.trust).toFixed(1)})</span>
                            </div>
                            <div class="flex justify-between" style="margin-bottom: var(--spacing-sm);">
                                <span class="text-sm" style="color: var(--slate-400);">Ethical Alignment:</span>
                                <span class="font-mono" style="color: var(--success);">${testScores.ethical.toFixed(1)} (+${(testScores.ethical - controlScores.ethical).toFixed(1)})</span>
                            </div>
                            <div class="flex justify-between" style="margin-bottom: var(--spacing-sm);">
                                <span class="text-sm" style="color: var(--slate-400);">Canvas Parity:</span>
                                <span class="font-mono" style="color: var(--success);">${testScores.canvas.toFixed(0)}% (+${(testScores.canvas - controlScores.canvas).toFixed(0)}%)</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-sm" style="color: var(--slate-400);">User Satisfaction:</span>
                                <span class="font-mono" style="color: var(--success);">${testScores.satisfaction.toFixed(1)} (+${(testScores.satisfaction - controlScores.satisfaction).toFixed(1)})</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: var(--spacing-lg); padding: var(--spacing-lg); background: rgba(16, 185, 129, 0.1); border: 1px solid var(--success); border-radius: var(--radius-md);">
                    <h4 style="color: var(--success); margin-bottom: var(--spacing-sm);">‚úÖ Conclusion</h4>
                    <p class="text-sm" style="color: var(--slate-300);">
                        Constitutional AI demonstrates statistically significant improvements across all metrics (p < 0.05, d = ${effectSize.toFixed(2)}). 
                        The test group showed ${((testScores.trust / controlScores.trust - 1) * 100).toFixed(1)}% higher trust scores and 
                        ${((testScores.satisfaction / controlScores.satisfaction - 1) * 100).toFixed(1)}% improved user satisfaction compared to traditional AI.
                    </p>
                </div>
            `;

            // Reset agent statuses
            phases.forEach(phase => {
                const statusEl = document.getElementById(`agent-${phase.toLowerCase()}-status`);
                if (statusEl) {
                    statusEl.textContent = 'IDLE';
                    statusEl.className = 'agent-status-badge';
                }
            });

            // Update metrics to reflect experiment completion
            updateMetricsWithVariation();
        }

        // ==================== EVENT LISTENERS ====================
        
        function initEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    const section = e.currentTarget.dataset.section;
                    navigateToSection(section);
                });
            });

            // Plain English Mode
            document.getElementById('plain-english-toggle').addEventListener('click', () => {
                state.plainEnglishMode = !state.plainEnglishMode;
                const button = document.getElementById('plain-english-toggle');
                button.textContent = state.plainEnglishMode ? 'üî§ Technical' : 'üìñ Plain English';
                // Re-render current section with new mode
                initializeSection(state.currentSection);
            });

            // Tutorial
            document.getElementById('tutorial-toggle').addEventListener('click', showTutorial);
            document.getElementById('start-tour').addEventListener('click', showTutorial);
            document.getElementById('skip-demo').addEventListener('click', () => navigateToSection('dashboard'));
            document.getElementById('close-tutorial').addEventListener('click', hideTutorial);
            document.getElementById('next-tutorial').addEventListener('click', nextTutorialStep);
            document.getElementById('prev-tutorial').addEventListener('click', prevTutorialStep);

            // Dashboard refresh
            document.getElementById('refresh-dashboard').addEventListener('click', async () => {
                state.trustScore = await generateTrustScore();
                state.metrics = generateMetrics();
                updateDashboard();
                updateDetectionMetrics();
            });

            // Experiment runner
            const runExpButton = document.getElementById('run-experiment');
            if (runExpButton) {
                runExpButton.addEventListener('click', runExperiment);
            }
        }

        // ==================== REAL-TIME UPDATES ====================
        
        function startRealTimeUpdates() {
            // Generate alerts occasionally when in detection section
            const alertsInterval = setInterval(() => {
                if (state.currentSection === 'detection' && Math.random() > 0.8) {
                    generateAlert();
                }
            }, 12000);

            // Update trust score occasionally with small variations
            const trustInterval = setInterval(async () => {
                // Only small random variations, not complete regeneration
                if (state.trustScore && Math.random() > 0.7) {
                    await updateTrustScoreWithVariation();
                    updateDashboard();
                    if (state.currentSection === 'principles') {
                        renderPrinciples();
                        initRadarChart();
                    }
                }
            }, 15000);

            state.intervals = [alertsInterval, trustInterval];
        }

        async function updateTrustScoreWithVariation() {
            if (!state.trustScore) return;

            // Apply small bounded variations to existing scores
            state.trustScore.principles = state.trustScore.principles.map(principle => {
                const variation = (Math.random() - 0.5) * 4; // ¬±2 points
                const newScore = Math.max(70, Math.min(100, principle.score + variation));
                const status = newScore >= 90 ? 'OK' : newScore >= 80 ? 'WARN' : 'FAIL';
                return { ...principle, score: Math.round(newScore), status };
            });

            // Recalculate total
            const total = Math.round(
                state.trustScore.principles.reduce((sum, p) => sum + (p.score * p.weight) / 100, 0)
            );
            const tier = total >= 95 ? 'HIGH' : total >= 85 ? 'MEDIUM' : total >= 70 ? 'LOW' : 'CRITICAL';

            // Generate new cryptographic receipt hash
            const receiptHash = await generateReceiptHash('trust-score-' + Date.now() + '-' + total);

            state.trustScore.total = total;
            state.trustScore.tier = tier;
            state.trustScore.timestamp = Date.now();
            state.trustScore.receiptHash = receiptHash.full;
        }

        function updateMetricsWithVariation() {
            if (!state.metrics) return;

            // Apply small bounded variations to existing metrics
            const variations = {
                throughput: (Math.random() - 0.5) * 200, // ¬±100
                latency: (Math.random() - 0.5) * 6, // ¬±3ms
                realityIndex: (Math.random() - 0.5) * 0.4, // ¬±0.2
                ethicalScore: (Math.random() - 0.5) * 0.3, // ¬±0.15
                identityCoherence: (Math.random() - 0.5) * 0.04, // ¬±0.02
                phaseVelocity: (Math.random() - 0.5) * 0.1 // ¬±0.05
            };

            state.metrics = {
                throughput: Math.max(1200, Math.min(2000, state.metrics.throughput + variations.throughput)),
                latency: Math.max(10, Math.min(50, state.metrics.latency + variations.latency)),
                activeSessions: state.metrics.activeSessions, // Keep stable
                realityIndex: Math.max(6.5, Math.min(9.0, parseFloat(state.metrics.realityIndex) + variations.realityIndex)).toFixed(1),
                ethicalScore: Math.max(2.8, Math.min(4.5, parseFloat(state.metrics.ethicalScore) + variations.ethicalScore)).toFixed(1),
                identityCoherence: Math.max(0.75, Math.min(0.95, parseFloat(state.metrics.identityCoherence) + variations.identityCoherence)).toFixed(2),
                phaseVelocity: Math.max(0.0, Math.min(0.8, parseFloat(state.metrics.phaseVelocity) + variations.phaseVelocity)).toFixed(3)
            };

            updateDetectionMetrics();
        }

        // ==================== INITIALIZATION ====================
        
        async function init() {
            console.log('Initializing SONATE Platform Demo...');

            try {
                // Generate initial data
                console.log('Generating trust score...');
                state.trustScore = await generateTrustScore();

                console.log('Generating receipts...');
                state.receipts = await generateReceipts(10);

                console.log('Generating agents...');
                state.agents = generateAgents();

                console.log('Generating metrics...');
                state.metrics = generateMetrics();

                // Initialize UI
                console.log('Updating dashboard...');
                updateDashboard();

                console.log('Updating detection metrics...');
                updateDetectionMetrics();

                // Setup event listeners
                console.log('Initializing event listeners...');
                initEventListeners();

                // Start real-time updates
                console.log('Starting real-time updates...');
                startRealTimeUpdates();

                // Hide loading screen
                console.log('Hiding loading screen...');
                await new Promise(resolve => setTimeout(resolve, 500));
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.classList.add('hidden');
                }

                console.log('SONATE Platform Demo initialized successfully');
            } catch (error) {
                console.error('Error during initialization:', error);
                throw error;
            }
        }

        // Start the application when DOM is ready
        function startApp() {
            // Simple synchronous initialization for demo
            console.log('Starting SONATE Platform Demo...');

            try {
                // Generate initial data synchronously
                state.trustScore = {
                    total: 87,
                    tier: 'MEDIUM',
                    principles: TRUST_PRINCIPLES.map(principle => ({
                        ...principle,
                        score: Math.floor(Math.random() * 30 + 70),
                        status: 'OK'
                    })),
                    timestamp: Date.now(),
                    receiptHash: 'demo-sha256-hash-abcdef123456...'
                };

                state.receipts = Array.from({ length: 10 }, (_, i) => ({
                    entryNumber: i + 1,
                    hash: `demo-hash-${i + 1}...`,
                    fullHash: `demo-full-hash-${i + 1}-abcdef123456789`,
                    action: 'Demo Action',
                    timestamp: new Date(Date.now() - i * 60000).toISOString(),
                    validated: Math.random() > 0.1,
                    trustScore: Math.floor(Math.random() * 20 + 80)
                }));

                state.agents = generateAgents();
                state.metrics = generateMetrics();

                // Initialize UI
                updateDashboard();
                updateDetectionMetrics();
                initEventListeners();

                // Hide loading screen
                setTimeout(() => {
                    const loadingScreen = document.getElementById('loading-screen');
                    if (loadingScreen) {
                        loadingScreen.classList.add('hidden');
                    }
                }, 1000);

                console.log('SONATE Platform Demo initialized successfully');
            } catch (error) {
                console.error('Failed to initialize demo:', error);
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.classList.add('hidden');
                }
                alert('Demo initialization failed. Using fallback mode.');
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', startApp);
        } else {
            startApp();
        }

        // Cleanup on unload
        window.addEventListener('beforeunload', () => {
            state.intervals.forEach(interval => clearInterval(interval));
            Object.values(state.charts).forEach(chart => {
                if (chart && typeof chart.destroy === 'function') {
                    chart.destroy();
                }
            });
        });
    </script>
</body>
</html>
